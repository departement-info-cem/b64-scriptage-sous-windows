<!doctype html>
<html lang="fr" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-cours/r08" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">R08 - Registre et streams | 420-B64-EM - Scriptage sous Windows </title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://info.cegepmontpetit.ca/b64-scriptage-sous-windows/cours/08"><meta data-rh="true" name="docusaurus_locale" content="fr"><meta data-rh="true" name="docsearch:language" content="fr"><meta data-rh="true" name="keywords" content="420-B64-EM - Scriptage sous Windows , Site de référence du cours de scriptage sous Windows (formation continue), informatique, technique, cégep, cegep, édouard-montpetit, edouard-montpetit, édouard montpetit, edouard montpetit"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="R08 - Registre et streams | 420-B64-EM - Scriptage sous Windows "><meta data-rh="true" name="description" content="1. Retour sur l&#x27;examen intra"><meta data-rh="true" property="og:description" content="1. Retour sur l&#x27;examen intra"><link data-rh="true" rel="icon" href="/b64-scriptage-sous-windows/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://info.cegepmontpetit.ca/b64-scriptage-sous-windows/cours/08"><link data-rh="true" rel="alternate" href="https://info.cegepmontpetit.ca/b64-scriptage-sous-windows/cours/08" hreflang="fr"><link data-rh="true" rel="alternate" href="https://info.cegepmontpetit.ca/b64-scriptage-sous-windows/cours/08" hreflang="x-default"><link rel="stylesheet" href="/b64-scriptage-sous-windows/assets/css/styles.e90ab40b.css">
<link rel="preload" href="/b64-scriptage-sous-windows/assets/js/runtime~main.475f7794.js" as="script">
<link rel="preload" href="/b64-scriptage-sous-windows/assets/js/main.d39d7ef7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Aller au contenu principal"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Aller au contenu principal</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Ouvrir/fermer la barre de navigation" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/b64-scriptage-sous-windows/"><div class="navbar__logo"><img src="/b64-scriptage-sous-windows/img/logo.svg" alt="Logo CEM" class="themedImage_ToTc themedImage--light_HNdA"><img src="/b64-scriptage-sous-windows/img/logo.svg" alt="Logo CEM" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">420-B64-EM - Scriptage sous Windows </b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/b64-scriptage-sous-windows/cours/01">Cours</a><a class="navbar__item navbar__link" href="/b64-scriptage-sous-windows/tutoriels/github-classroom-simple">Tutoriels</a><a class="navbar__item navbar__link" href="/b64-scriptage-sous-windows/tp/tp1">Travaux Pratiques</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-label="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Retour au début de la page" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/b64-scriptage-sous-windows/cours/01">R01 - Accueil</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/b64-scriptage-sous-windows/cours/02">R02 - Objets et pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/b64-scriptage-sous-windows/cours/03">R03 - Dictionnaires et scripts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/b64-scriptage-sous-windows/cours/04">R04 - Paramètres, fonctions, fichiers et strings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/b64-scriptage-sous-windows/cours/05">R05 - Gestion des comptes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/b64-scriptage-sous-windows/cours/06">R06 - TP1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/b64-scriptage-sous-windows/cours/07">R07 - Examen intra</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/b64-scriptage-sous-windows/cours/08">R08 - Registre et streams</a></li></ul></nav><button type="button" title="Réduire le menu latéral" aria-label="Réduire le menu latéral" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Fil d&#x27;Ariane"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Page d&#x27;accueil" class="breadcrumbs__link" href="/b64-scriptage-sous-windows/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">R08 - Registre et streams</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Sur cette page</button></div><div class="theme-doc-markdown markdown"><h1>Rencontre 8 - Registre et streams</h1><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Résumé de la séance</div><div class="admonitionContent_S0QG"><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">👨‍🏫 Déroulement du cours</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">💻 Exercices à compléter</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">📚 Ressources à consulter</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><ol><li>Retour sur l&#x27;examen intra</li><li>Les fournisseurs PowerShell et les PSDrives</li><li>Le registre de Windows</li><li>L&#x27;accès au registre avec PowerShell</li><li>Les streams</li></ol></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>Exercice 8 sur OneNote</p></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>La présentation PowerPoint est sur le Teams du cours, sous le canal Général &gt; Fichiers &gt; Supports de cours.</p></div></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="psprovider-et-psdrive"><em>PSProvider</em> et <em>PSDrive</em><a href="#psprovider-et-psdrive" class="hash-link" aria-label="Lien direct vers psprovider-et-psdrive" title="Lien direct vers psprovider-et-psdrive">​</a></h2><p>Les <strong>fournisseurs PowerShell</strong> (appelés <em>PSProvider</em>) sont des couches d&#x27;abstraction permettant d&#x27;obtenir des données de différentes natures de manière uniforme.</p><p>Par exemple, le système de fichiers, les variables d&#x27;environnement et le registre sont des systèmes de données très différents. Grâce aux providers, on peut les interroger de la même manière et avec les mêmes commandes.</p><p><img loading="lazy" alt="Get-PSProvider" src="/b64-scriptage-sous-windows/assets/images/get-psprovider-243622eb446f628392ba0d39714b7b57.png" width="682" height="242" class="img_ev3q"></p><p>Voici les principaux providers</p><table><thead><tr><th>Nom</th><th>Description</th></tr></thead><tbody><tr><td>FileSystem</td><td>Ce provider procure un accès au système de fichiers.</td></tr><tr><td>Registry</td><td>Ce provider permet de manipuler la base de registre.</td></tr><tr><td>Alias</td><td>Ce provider permet de manipuler les alias PowerShell</td></tr><tr><td>Variable</td><td>Ce provider permet d&#x27;interroger et gérer les variables PowerShell</td></tr><tr><td>Function</td><td>Ce provider permet d&#x27;interroger et gérer les fonctions PowerShell</td></tr><tr><td>Environment</td><td>Ce provider donne accès aux variables d&#x27;environnement de la session en cours</td></tr></tbody></table><p>Les <strong>lecteurs PowerShell</strong> (<em>PSDrive</em>) sont des points d&#x27;entrée vers une ressource gérée par un <em>PSProvider</em>. Par exemple, les lecteurs C: et D: sont des lecteurs contenant un système de fichiers, accessible via le fournisseur <em>FileSystem</em>.</p><p><img loading="lazy" alt="Get-PSDrive" src="/b64-scriptage-sous-windows/assets/images/get-psdrive-92562e1f48e820d522723abb0f645dcb.png" width="568" height="301" class="img_ev3q"></p><p>Plusieurs commandes PowerShell adoptent un comportement différent en fonction du fournisseur duquel le chemin spécifié est issu. </p><p>Dans l&#x27;exemple ci-dessous, on peut voir que le type d&#x27;élément retourné par <code>Get-ChildItem</code> est différent selon que le lecteur spécifié en est un exposé par le fournisseur <code>FileSystem</code> ou par le fournisseur <code>Environment</code> (qui contient les variables d&#x27;environnement).</p><p><img loading="lazy" alt="Get-PSDrive" src="/b64-scriptage-sous-windows/assets/images/gci-provider-ba46506de848cc01e312a6c7ffa2d151.png" width="568" height="383" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="le-registre-de-windows">Le registre de Windows<a href="#le-registre-de-windows" class="hash-link" aria-label="Lien direct vers Le registre de Windows" title="Lien direct vers Le registre de Windows">​</a></h2><p>Le registre de Windows est une base de données interne à Windows qui sert à <strong>centraliser la configuration</strong> du système d&#x27;exploitation et de ses applications afin d&#x27;éviter l&#x27;éparpillement de fichiers de configuration.</p><p>Le registre est un composant fondamental du système d&#x27;exploitation. Windows offre diverses méthodes permettant aux applications et aux scripts de lire et d&#x27;écrire des valeurs dans le registre.</p><p>L&#x27;éditeur de registre (regedit.exe) est un outil intégré à Windows qui permet d&#x27;explorer le registre à l&#x27;aide d&#x27;une interface graphique, à l&#x27;instar de l&#x27;explorateur de fichiers permet d&#x27;explorer graphiquement le système de fichiers.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="structure-du-registre">Structure du registre<a href="#structure-du-registre" class="hash-link" aria-label="Lien direct vers Structure du registre" title="Lien direct vers Structure du registre">​</a></h3><p>Le registre de Windows est composé de deux types d&#x27;éléments: les <strong>clés</strong> (<em>keys</em>) et les <strong>valeurs</strong> (<em>values</em>).</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/registre_cles-val-e9bb0ae3814d4a36517980ea301b1d8e.png" width="704" height="428" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="clés">Clés<a href="#clés" class="hash-link" aria-label="Lien direct vers Clés" title="Lien direct vers Clés">​</a></h3><p>Les <strong>clés</strong> sont des conteneurs, un peu comme les répertoires dans un système de fichiers. Elles peuvent contenir des valeurs ainsi que d&#x27;autres clés (qu&#x27;un appellera sous-clés, ou <em>subkeys</em>). Les premières clés, situées au premier niveau de l&#x27;arborescence, sont appelés des <strong>clés de ruche</strong> (<em>hive key</em>) ou des <strong>clés racine</strong> (<em>root key</em>) et ont pour préfixe HKEY_ (un diminutif de <em>hive key</em>).</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/registre_cles-cd8c4df1b49f215759b47cef94b81b31.png" width="427" height="327" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="valeurs">Valeurs<a href="#valeurs" class="hash-link" aria-label="Lien direct vers Valeurs" title="Lien direct vers Valeurs">​</a></h3><p>Les <strong>valeurs</strong> sont des éléments porteurs de données utilisables. Ils sont comparables aux fichiers dans un système de fichiers, mais leur contenu tend à être beaucoup plus petit et circonscrit à une propriété ou à une configuration unique. </p><p>Chaque valeur de registre est contenue dans une clé et possède trois attributs: un <strong>nom</strong>, un <strong>type</strong> et une <strong>donnée</strong>.</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/registre_val-09f614b8f70fd1f34b84e88f94f11d85.png" width="604" height="230" class="img_ev3q"></p><p>Les données inscrite dans une clé doivent être d&#x27;un type précis. Voici les principaux types de données admissibles pour une valeur de registre:</p><table><thead><tr><th>Type</th><th>Nom</th><th>Description</th></tr></thead><tbody><tr><td>REG_SZ</td><td>String</td><td>Une chaîne de caractères</td></tr><tr><td>REG_MULTI_SZ</td><td>MultiString</td><td>Un tableau de chaînes de caractères</td></tr><tr><td>REG_EXPAND_SZ</td><td>ExpandString</td><td>Une chaîne de caractères avec variables d&#x27;environnement (ex. %APPDATA%)</td></tr><tr><td>REG_DWORD</td><td>DWord</td><td>Une valeur numérique de 32 bits (équivalent à <!-- -->[uint32]<!-- -->)</td></tr><tr><td>REG_QWORD</td><td>QWord</td><td>Une valeur numérique de 64 bits (équivalent à <!-- -->[uint64]<!-- -->)</td></tr><tr><td>REG_BINARY</td><td>Binary</td><td>Des données binaires brutes</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fichiers-du-registre">Fichiers du registre<a href="#fichiers-du-registre" class="hash-link" aria-label="Lien direct vers Fichiers du registre" title="Lien direct vers Fichiers du registre">​</a></h3><p>La base de registre est composée de plusieurs fichiers, appelés <strong>ruches</strong> (<em>hive</em>). Au démarrage de Windows (ou d&#x27;une session utilisateur), Voici les principaux fichiers qui sont chargés:</p><table><thead><tr><th>Clé</th><th>Fichier</th><th>Portée</th></tr></thead><tbody><tr><td>HKEY_LOCAL_MACHINE\SOFTWARE</td><td>C:\Windows\System32\config\SOFTWARE</td><td>Système</td></tr><tr><td>HKEY_LOCAL_MACHINE\SECURITY</td><td>C:\Windows\System32\config\SECURITY</td><td>Système</td></tr><tr><td>HKEY_LOCAL_MACHINE\SYSTEM</td><td>C:\Windows\System32\config\SYSTEM</td><td>Système</td></tr><tr><td>HKEY_LOCAL_MACHINE\SAM</td><td>C:\Windows\System32\config\SAM</td><td>Système</td></tr><tr><td>HKEY_USERS<!-- -->\<!-- -->.DEFAULT</td><td>C:\Windows\System32\config\DEFAULT</td><td>Système</td></tr><tr><td>HKEY_CURRENT_USER</td><td>%UserProfile%\NTUSER.DAT</td><td>Utilisateur</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="principales-racines">Principales racines<a href="#principales-racines" class="hash-link" aria-label="Lien direct vers Principales racines" title="Lien direct vers Principales racines">​</a></h3><p>Dans le registre, il y a deux racines fondamentales. </p><ul><li><strong><code>HKEY_LOCAL_MACHINE (HKLM)</code></strong> rassemble la configuration globale du système</li><li><strong><code>HKEY_USERS (HKU)</code></strong> rassemble la configuration des utilisateurs</li></ul><p>Il y a aussi plusieurs racines alias, sorte de raccourcis vers certaines parties des racines fondamentales.</p><ul><li><strong><code>HKEY_CURRENT_USER (HKCU)</code></strong> contient la configuration du profil de l&#x27;utilisateur courant. Elle est un raccourci vers <code>HKU\SID_de_l&#x27;utilisateur</code>.</li><li><strong><code>HKEY_CLASSES_ROOT (HKCR)</code></strong> contient la configuration des classes de fichiers et de protocoles, issue de la superposition de <code>HKCU\SOFTWARE\Classes</code> et <code>HKLM\SOFTWARE\Classes</code></li><li><strong><code>HKEY_CURRENT_CONFIG (HKCC)</code></strong> contient de l&#x27;information sur le profil matériel du système. </li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="hkey_current_user-hkcu">HKEY_CURRENT_USER (HKCU)<a href="#hkey_current_user-hkcu" class="hash-link" aria-label="Lien direct vers HKEY_CURRENT_USER (HKCU)" title="Lien direct vers HKEY_CURRENT_USER (HKCU)">​</a></h4><p>La clé racine <code>HKEY_CURRENT_USER</code>, ou <code>HKCU</code> en abrégé, contient les données de configuration <strong>propres à l&#x27;utilisateur</strong>. Chaque utilisateur possède sa propre ruche. Ces données sont comprises dans le fichier <code>NTUSER</code>.DAT situé dans le profil utilisateur sous <code>C:\Users\</code>. </p><p>L&#x27;utilisateur n&#x27;a pas besoin d&#x27;être administrateur local pour écrire ou modifier des valeurs dans cette ruche, puisque celle-ci appartient à l&#x27;utilisateur.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="hkey_local_machine-hklm">HKEY_LOCAL_MACHINE (HKLM)<a href="#hkey_local_machine-hklm" class="hash-link" aria-label="Lien direct vers HKEY_LOCAL_MACHINE (HKLM)" title="Lien direct vers HKEY_LOCAL_MACHINE (HKLM)">​</a></h4><p>La clé racine <code>HKEY_LOCAL_MACHINE</code>, ou <code>HKLM</code> en abrégé, contient les données de configuration <strong>globales du système</strong>. Ces configurations sont les mêmes peu importe l&#x27;utilisateur connecté.</p><p>On doit obligatoirement posséder des droits d&#x27;administration pour modifier les valeurs contenues dans cette ruche.</p><p>La plupart des paramètres propres aux éléments logiciels (y compris les paramètres du système d&#x27;exploitation) sont situés dans la clé SOFTWARE.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>astuce</div><div class="admonitionContent_S0QG"><p>De nos jours, Windows est presque toujours installé dans son édition 64 bits. Cependant, certaines applications plus vieilles ont été compilées pour une architecture de processeur 32 bits. Windows 10/11 et Windows Server possèdent un sous-système d&#x27;émulation permettant d&#x27;exécuter des programmes 32 bits. Ce sous-système s&#x27;appelle &quot;WoW64&quot;, pour &quot;<em>Windows-on-Windows 64-bit</em>&quot;. </p><p>Les fichiers des logiciels 32-bits installés dans une éditions 64-bits de Windows sont situés dans le répertoire <code>C:\Program Files (x86)\</code> (référencé par la variable d&#x27;environnement <code>%ProgramFiles(x86)%</code>, ou <code>$env:{ProgramFiles(x86)}</code> en PowerShell). Leurs paramètres dans le registre sont situés sous la clé <code>HKLM\SOFTWARE\WOW6432Node\</code>.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="hkey_users-hku">HKEY_USERS (HKU)<a href="#hkey_users-hku" class="hash-link" aria-label="Lien direct vers HKEY_USERS (HKU)" title="Lien direct vers HKEY_USERS (HKU)">​</a></h4><p>La clé racine <code>HKEY_USERS</code> (en abrégé <code>HKU</code>) est une des racines fondamentales de Windows et comprend tous les utilisateurs qui ont une session ouverte.</p><p>La clé <code>.DEFAULT</code> représente le profil utilisateur du compte SYSTEM, et les autres clés sont identifiées par le SID de l&#x27;utilisateur.</p><p>La ruche de l&#x27;utilisateur courant est accessible par <code>HKEY_CURRENT_USER</code>.</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/hku-3aeae99eafba9be340662019deba5d9c.png" width="407" height="299" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="hkey_classes_root-hkcr">HKEY_CLASSES_ROOT (HKCR)<a href="#hkey_classes_root-hkcr" class="hash-link" aria-label="Lien direct vers HKEY_CLASSES_ROOT (HKCR)" title="Lien direct vers HKEY_CLASSES_ROOT (HKCR)">​</a></h4><p>La clé racine <code>HKEY_CLASSES_ROOT</code> (en abrégé <code>HKCR</code>) contient la configuration des types de documents, d&#x27;extensions et des protocoles pris en charge par Windows. L&#x27;organisation de cette racine est assez complexe, mais essentielle à Windows puisque c&#x27;est là qu&#x27;est rassemblée toute l&#x27;information qui permet à Windows de savoir, par exemple, quelle application démarrer si on double-clique sur un fichier portant une extension, quelles sont les options disponibles dans le menu contextuel, etc.</p><p>Cette racine est en fait une combinaisaison de deux clés:</p><ul><li><code>HKEY_LOCAL_MACHINE\SOFTWARE\Classes</code> (la configuration système)</li><li><code>HKU\(sid)_CLASSES</code> (la configuration utilisateur)</li></ul><p>Un paramètre défini dans la configuration utilisateur a préséance sur le même paramètre défini dans la configuration système.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>astuce</div><div class="admonitionContent_S0QG"><p>La partie <em>Classes</em> du profil utilisateur n&#x27;est pas sauvegardée dans <code>%USERPROFILE%\NTUSER.DAT</code> comme le reste de sa ruche, elle est dans un fichier différent: <code>%LOCALAPPDATA%\Microsoft\Windows\UsrClass.dat</code></p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="accès-au-registre-avec-powershell">Accès au registre avec PowerShell<a href="#accès-au-registre-avec-powershell" class="hash-link" aria-label="Lien direct vers Accès au registre avec PowerShell" title="Lien direct vers Accès au registre avec PowerShell">​</a></h2><p>On peut facilement lire et écrire des informations dans le registre de Windows via le fournisseur <code>Registry</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="obtenir-la-liste-des-sous-clés-dune-clé">Obtenir la liste des sous-clés d&#x27;une clé<a href="#obtenir-la-liste-des-sous-clés-dune-clé" class="hash-link" aria-label="Lien direct vers Obtenir la liste des sous-clés d&#x27;une clé" title="Lien direct vers Obtenir la liste des sous-clés d&#x27;une clé">​</a></h3><p>On obtient la liste des sous-clé d&#x27;une clé avec la commande <code>Get-ChildItem</code>.</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/reg_subkey1-c81a5c1f302dca0fece27af2f987f95a.png" width="568" height="252" class="img_ev3q"></p><p>Pour voir seulement la liste des clés, sans montrer aussi les valeurs qui y sont contenues, on peut ajouter le <em>switch</em> <code>-Name</code>.</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/reg_subkey2-0d214d01f105b8a8d2700a43b174e8b1.png" width="568" height="165" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tester-si-une-clé-existe">Tester si une clé existe<a href="#tester-si-une-clé-existe" class="hash-link" aria-label="Lien direct vers Tester si une clé existe" title="Lien direct vers Tester si une clé existe">​</a></h3><p>Pour tester si une clé existe, c&#x27;est très simple: il suffit d&#x27;utiliser <code>Test-Path</code>.</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/reg_testkey-2a4c8135db863933aaa6a85087d8b7ff.png" width="710" height="136" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="créer-une-clé">Créer une clé<a href="#créer-une-clé" class="hash-link" aria-label="Lien direct vers Créer une clé" title="Lien direct vers Créer une clé">​</a></h3><p>Pour créer une nouvelle clé, on peut utiliser la commande <code>New-Item</code>.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">New-Item</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Path </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;HKCU:\SOFTWARE\MaNouvelleClé&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/reg_newkey1-2bfb60768371c30986e399237027a170.png" width="710" height="234" class="img_ev3q"></p><p>Pour que ça fonctionne, la clé parente doit exister. On peut cependant spécifier le switch <code>-Force</code> pour que l&#x27;arborescence de clé soit automatiquement créée.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">New-Item</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Path </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;HKCU:\SOFTWARE\UneClé\UneSousClé\UneSousSousClé&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Force</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/reg_newkey2-89432f13ec88ca27d2f58256231af217.png" width="710" height="378" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="effacer-une-clé">Effacer une clé<a href="#effacer-une-clé" class="hash-link" aria-label="Lien direct vers Effacer une clé" title="Lien direct vers Effacer une clé">​</a></h3><p>Pour effacer une clé, il suffit d&#x27;utiliser la commande <code>Remove-Item</code>.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Remove-Item</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Path </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;HKCU:\SOFTWARE\MaNouvelleClé&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="data:image/png;base64,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t/BdKZZM464UN3x/n3Ta/Nr/NY0RiYiIiMjtwABMw+G61eO4qUznNi5/73zMLeKmS8FYREREZHZN+P+ZDz74IOPlV65cSX5+PsDLwHngY/u/pmma9vmnrBjfiQzv6yxJ8UAQEREREfn80SOhRURERET4nFaMs0HtEiIiIiJ3FlWMRURERERQMBYRERERARSMRUREREQABWMREREREUDBWEREREQE0F0pREREROQ2tnLlypu2LVWMRURERERQMBYRERERARSMRUREREQABWMRERERmUOampqm9fp0KBiLiIiIyJwSH4KzEYpBwVhERERE5qBwGM5WKAYFYxERERGZQ1pbWyPf20Ox/fVMKRiLiIiIyJwSH4KzEYpBwVhERERE5qBwGM5WKAYFYxERERGZo7IZikHBWEREREQEUDAWEREREQEUjEVEREREAAVjEREREREAFgCYgfZbPQ4RERERkRiGcXMz6gLTNI3YARiLgWUJvkRERERE5qL/B/wJuAxcBcZM0zTjZ1qQYMFPgLuAhcD80GsTszRIEREREZHZ9ifgIlYwHsXKu5NMCsamaZqGYYwS7T++AXw2S4MUEREREZltl21fo4mqxZC4YoxpmtcMw7iCVSn+DBifrVGKiIiIiMyyq1iV4lHTNK8lm8lIEpitiYZhAF8CFmd9eCIiIiIiN8cY8EmySnFYymAcmckKyCIiIiIic85UgTgsrWAsIiIiInKn0wM+RERERERQMBYRERERARSMRUREREQA+P+Tr31HhF7ZZgAAAABJRU5ErkJggg==" width="710" height="91" class="img_ev3q"></p><p>Si cette clé contient des sous-clés, on peut spécifier le switch <code>-Recurse</code> pour effacer récursivement toutes les sous-clés.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Remove-Item</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Path </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;HKCU:\SOFTWARE\UneClé&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Recurse</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="obtenir-les-valeurs-dans-une-clé">Obtenir les valeurs dans une clé<a href="#obtenir-les-valeurs-dans-une-clé" class="hash-link" aria-label="Lien direct vers Obtenir les valeurs dans une clé" title="Lien direct vers Obtenir les valeurs dans une clé">​</a></h3><p>Pour obtenir toutes les valeurs dans une certaine clé, on peut utiliser la commande <code>Get-ItemProperty</code>.</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/reg_val1-e57403d4f167b39bbba661561eba985f.png" width="710" height="205" class="img_ev3q"></p><p>Pour obtenir une valeur spécifique, on peut utiliser la commande <code>Get-ItemPropertyValue</code> en spécifiant la clé comme chemin et le nom de la valeur.</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/reg_val2-45b1d08eb21919c03ddb2a96b17aee45.png" width="710" height="126" class="img_ev3q"></p><p>Il existe plusieurs autres manières d&#x27;obtenir les données dans une valeur de registre. Voici quelques autres exemples:</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/reg_val3-8720a78ddcc7dbb4f05f659a9508f91c.png" width="710" height="176" class="img_ev3q"></p><p>On peut aussi utiliser la méthode <code>.GetValue()</code> d&#x27;une clé, comme le montre l&#x27;exemple ci-dessous:</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/reg_val4-806c699b5b830ec278e5b17aea5cf412.png" width="710" height="119" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tester-si-une-valeur-existe">Tester si une valeur existe<a href="#tester-si-une-valeur-existe" class="hash-link" aria-label="Lien direct vers Tester si une valeur existe" title="Lien direct vers Tester si une valeur existe">​</a></h3><p>Voici une manière de tester si une valeur existe. Elle consiste à rechercher toutes les valeurs dans la clé spécifiée, puis filtrer pour ne ressortir que celle dont le nom correspond à ce qu&#x27;on cherche. </p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-ItemProperty</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Path </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;HKCU:\Uneclé\&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Where-Object</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Property </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;UnNomDeValeur&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Si le résultat de cette ligne ne sort rien (donc <code>$null</code>), ça signifie que la valeur n&#x27;existe pas dans cette clé. Autrement, la commande donne quelque chose, donc n&#x27;est pas <code>$null</code>.</p><p>On peut intégrer cette logique dans une condition.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token variable" style="color:rgb(9, 134, 88)">$CheminCl</span><span class="token plain">é = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;HKCU:\Chemin\vers\une\clé\&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$NomValeur</span><span class="token plain"> = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;MaValeur&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">Get-ItemProperty</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Path </span><span class="token variable" style="color:rgb(9, 134, 88)">$CheminCl</span><span class="token plain">é </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Where-Object</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Property </span><span class="token variable" style="color:rgb(9, 134, 88)">$NomValeur</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># La valeur existe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># La valeur n&#x27;existe pas</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ou encore, à l&#x27;inverse...</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token variable" style="color:rgb(9, 134, 88)">$CheminCl</span><span class="token plain">é = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;HKCU:\Chemin\vers\une\clé\&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$NomValeur</span><span class="token plain"> = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;MaValeur&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">-not</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">Get-ItemProperty</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Path </span><span class="token variable" style="color:rgb(9, 134, 88)">$CheminCl</span><span class="token plain">é </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Where-Object</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Property </span><span class="token variable" style="color:rgb(9, 134, 88)">$NomValeur</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># La valeur n&#x27;existe pas</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># La valeur existe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>astuce</div><div class="admonitionContent_S0QG"><p>Si la clé n&#x27;existe pas, Get-ItemProperty retournera une erreur. Pour masquer cette erreur, on peut spécifier <code>-ErrorAction SilentlyContinue</code></p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/reg_testval_error-3e41dc35b6d5732aaf0cd0301f8b8d18.png" width="637" height="268" class="img_ev3q"></p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="créer-une-valeur">Créer une valeur<a href="#créer-une-valeur" class="hash-link" aria-label="Lien direct vers Créer une valeur" title="Lien direct vers Créer une valeur">​</a></h3><p>Pour créer une valeur dans le registre, on peut utiliser la commande <code>New-ItemProperty</code>.</p><p>Voici un exemple qui modifie la configuration du bloc-notes de Windows pour que la police de caractères soit &quot;Comic Sans MS&quot;.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token variable" style="color:rgb(9, 134, 88)">$NewRegValSplat</span><span class="token plain"> = @</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Path = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;HKCU:\SOFTWARE\Microsoft\Notepad\&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Name = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;lfFaceName&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    PropertyType = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;String&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Value = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Comic Sans MS&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">New-ItemProperty</span><span class="token plain"> @NewRegValSplat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Pour créer une valeur numérique, il suffit de faire définir le type à &quot;Dword&quot;.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token variable" style="color:rgb(9, 134, 88)">$NewRegValSplat</span><span class="token plain"> = @</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Path = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;HKCU:\SOFTWARE\MonScript\&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Name = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;MaValeurNumérique&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    PropertyType = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Dword&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Value = 123</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">New-ItemProperty</span><span class="token plain"> @NewRegValSplat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="modifier-une-valeur-existante">Modifier une valeur existante<a href="#modifier-une-valeur-existante" class="hash-link" aria-label="Lien direct vers Modifier une valeur existante" title="Lien direct vers Modifier une valeur existante">​</a></h3><p>Pour modifier une valeur de registre existante, on peut utiliser la commande <code>Set-ItemProperty</code>. La valeur doit déjà exister pour que cette commande fonction</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token variable" style="color:rgb(9, 134, 88)">$NewRegValSplat</span><span class="token plain"> = @</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Path = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;HKCU:\SOFTWARE\Microsoft\Notepad\&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Name = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;lfFaceName&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    PropertyType = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;String&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Value = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Comic Sans MS&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">New-ItemProperty</span><span class="token plain"> @NewRegValSplat </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Force</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>astuce</div><div class="admonitionContent_S0QG"><p>Pour créer une valeur si elle n&#x27;existe pas ou la modifier si elle existe, dans une seule commande, il suffit d&#x27;activer le paramètre <code>-Force</code> de <code>New-ItemProperty</code>. Ceci va forcer la création de la valeur, en l&#x27;écrasant si elle existe</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token variable" style="color:rgb(9, 134, 88)">$NewRegValSplat</span><span class="token plain"> = @</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Path = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;HKCU:\SOFTWARE\MonScript\&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Name = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;MaValeurNumérique&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    PropertyType = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Dword&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Value = 123</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">New-ItemProperty</span><span class="token plain"> @NewRegValSplat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="effacer-une-valeur">Effacer une valeur<a href="#effacer-une-valeur" class="hash-link" aria-label="Lien direct vers Effacer une valeur" title="Lien direct vers Effacer une valeur">​</a></h3><p>Pour effacer une valeur de registre, on peut utiliser la commande <code>Remove-ItemProperty</code>.</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/reg_delval-6e80924c693f27e2bc535e7696dde20c.png" width="710" height="116" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="streams">Streams<a href="#streams" class="hash-link" aria-label="Lien direct vers Streams" title="Lien direct vers Streams">​</a></h2><p>PowerShell utilise divers &quot;<em>streams</em>&quot; pour passer des objets. On connaît déjà le <em>stream</em> principal; c&#x27;est lui qu&#x27;on appelle le <em>pipeline</em> de PowerShell. On le qualifie également de <em>stream</em> 1 et <em>stream</em> de sortie (<em>output stream</em>). Il y a d&#x27;autres <em>streams</em>, pour permettre la circulation d&#x27;autres types d&#x27;objets.</p><table><thead><tr><th>#</th><th>Stream</th><th>Commande pour y écrire</th><th>Description</th></tr></thead><tbody><tr><td>1</td><td>Output / Success</td><td><code>Write-Output</code></td><td>C&#x27;est le pipeline principal. La commande <code>Write-Output</code> est facultative; tout objet qui résulte d&#x27;une commande sans être affecté à une variable tombe dans ce <em>stream</em>.</td></tr><tr><td>2</td><td>Error</td><td><code>Write-Error</code></td><td>C&#x27;est dans ce <em>stream</em> que circulent les erreurs, qui sont affichées en rouge avec de l&#x27;information supplémentaire.</td></tr><tr><td>3</td><td>Warning</td><td><code>Write-Warning</code></td><td>On peut envoyer des messages d&#x27;avertissement dans ce <em>stream</em>. Ils seront affichés d&#x27;une autre couleur dans la console avec une mention d&#x27;avertissement.</td></tr><tr><td>4</td><td>Verbose</td><td><code>Write-Verbose</code></td><td>Ce <em>stream</em> est destiné au texte de verbose. Un script ou une commande peut écrire une sortie plus détaillée, qui est masquée par défaut. Il faut activer la verbose pour le voir, soit avec le paramètre <code>-Verbose</code> ou avec la variable <code>$VerbosePreference</code>.</td></tr><tr><td>5</td><td>Debug</td><td><code>Write-Debug</code></td><td>Ce <em>stream</em> permet la circulation d&#x27;information de débogage. Comme pour la verbose, ce qui y circule est caché par défaut.</td></tr><tr><td>6</td><td>Information</td><td><code>Write-Information</code></td><td>Ce <em>stream</em> permet la circulation d&#x27;information supplémentaire pouvant aider au développement. Comme pour la verbose, ce qui y est envoyé est caché par défaut. <code>Write-Host</code>, tout en écrivant du texte dans la console, envoie aussi une copie de ce texte dans le <em>stream</em> Information.</td></tr></tbody></table><p>Les différentes commandes <code>Write-____</code> permettent d&#x27;envoyer des objets dans un stream particulier.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">&quot;Ceci est envoyé dans le stream Output (le pipeline principal de PowerShell).&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Write-Output</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Ceci est aussi envoyé dans le stream Output (le pipeline principal de PowerShell).&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Write-Error</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Ceci est envoyé dans le stream Error, et sera écrit en rouge avec des infos supplémentaires.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Write-Warning</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Ceci est envoyé dans le stream Warning et sera écrit en jaune avec une mention d&#x27;avertissement.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Write-Verbose</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Ceci est envoyé dans le stream Verbose et ne sera pas affiché par défaut.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Write-Debug</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Ceci est envoyé dans le stream Debug et ne sera pas affiché par défaut.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Write-Information</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Ceci est envoyé dans le stream Information et ne sera pas affiché par défaut.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Ceci est écrit directement dans la console, ainsi que dans le stream Information.&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="stream-1-output--success">Stream 1: Output / Success<a href="#stream-1-output--success" class="hash-link" aria-label="Lien direct vers Stream 1: Output / Success" title="Lien direct vers Stream 1: Output / Success">​</a></h3><p>Le stream Output est tout simplement le pipeline PowerShell que vous connaissez déjà. C&#x27;est dans ce stream que les commandes produisent leurs objets de sortie. La commande Write-Output sert à envoyer des objets dans ce stream, mais ce n&#x27;est pas nécessaire puisque tous les objets y circulent par défaut.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="stream-2-error">Stream 2: Error<a href="#stream-2-error" class="hash-link" aria-label="Lien direct vers Stream 2: Error" title="Lien direct vers Stream 2: Error">​</a></h3><p>Le stream Error est le &quot;pipeline&quot; sur lequel les erreurs circulent. Les objets circulant dans ce stream sont ultimement convertis en texte pour son affichage dans la console, mais ce texte est formaté en rouge avec des informations sur l&#x27;erreur. </p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/stream_error01-090ceef36db033abe6bc1aa4e6ae5f9a.png" width="632" height="230" class="img_ev3q"></p><p>On peut produire des erreurs avec la commande <code>Write-Error</code>.</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/stream_error02-a2330bf0c1255f5c61f25dbbe10b5531.png" width="632" height="170" class="img_ev3q"></p><p>Il est possible de cacher ou ignorer les erreurs et spécifiant à une commande une action en cas d&#x27;erreur. Par exemple, <code>-ErrorAction SilentlyContinue</code> fait en sorte que la sortie de ce stream ne sera pas affichée.</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/stream_error03-5b92c4a4aa80eda91b8f2b5ab3a9ffed.png" width="632" height="146" class="img_ev3q"></p><p>On peut aussi le faire globalement en modifiant la variable <code>$ErrorActionPreference</code>. Par défaut, l&#x27;action en cas d&#x27;erreur est &quot;Continue&quot;, mais vous pouvez la changer pour &quot;SilentlyContinue&quot; pour que toutes les erreurs n&#x27;apparaissent pas dans la console. Notez que cette variable ne sera modifiée que pour la session PowerShell en cours.</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/stream_error04-d883ac5c1633db3633f3fa58ef8e34b5.png" width="632" height="172" class="img_ev3q"></p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>Voici les valeurs d&#x27;action supportées pour les erreurs. Ces actions sont sensiblement les mêmes pour la préférence de traitement des autres streams.</p><table><thead><tr><th>Action</th><th>Effet</th></tr></thead><tbody><tr><td>Stop</td><td>Arrêt immédiat du script ou de la fonction.</td></tr><tr><td>Continue</td><td>Le script ou la fonction affiche signale une erreur mais poursuit son exécution (c&#x27;est le comportement par défaut pour les erreurs).</td></tr><tr><td>SilentlyContinue</td><td>Le script continue et n&#x27;affiche aucun message d&#x27;erreur, mais l&#x27;erreur est tout de même envoyée dans le <em>stream</em>.</td></tr><tr><td>Ignore</td><td>Ignore les erreurs sans aucun signalement. (Cette valeur est inadmissible dans <code>$ErrorActionPreference</code>.)</td></tr><tr><td>Inquire</td><td>Le script affiche le message d&#x27;erreur et demande à l&#x27;utilisateur s&#x27;il souhaite continuer ou arrêter.</td></tr></tbody></table></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="stream-3-warning">Stream 3: Warning<a href="#stream-3-warning" class="hash-link" aria-label="Lien direct vers Stream 3: Warning" title="Lien direct vers Stream 3: Warning">​</a></h3><p>Ce stream est utilisé pour écrire des messages d&#x27;avertissement à l&#x27;utilisateur. On pourrait le faire à l&#x27;aide de Write-Host, mais le stream Warning offre la même fonctionnalité que celui des erreurs: par le paramètre <code>-WarningAction</code> ou une changement à la variable <code>$WarningPreference</code>, qui est par défaut à &quot;Continue&quot;, on peut modifier le comportement en cas d&#x27;avertissement. Ainsi, en spécifiant l&#x27;action &quot;SilentlyContinue&quot;, les avertissements seront masqués.</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/stream_warning01-a539b30a975ade89ff77bd9dc0a24838.png" width="632" height="168" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="stream-4-verbose">Stream 4: Verbose<a href="#stream-4-verbose" class="hash-link" aria-label="Lien direct vers Stream 4: Verbose" title="Lien direct vers Stream 4: Verbose">​</a></h3><p>Ce stream est utilisé pour écrire des messages détaillés, si l&#x27;utilisateur le souhaite. La commande pour y envoyer des messages est <code>Write-Verbose</code>. Les messages passés dans ce stream sont masqués par défaut, ce qui laisse l&#x27;impression que la commande ne fait rien. Comme pour les autres streams, il existe une variable qui contrôle si le message est affiché ou non. Dans le cas du stream Verbose, cette variable est <code>$VerbosePreference</code> et sa valeur par défaut est &quot;SilentlyContinue&quot;. On peut la changer à &quot;Continue&quot; pour que l&#x27;affichage de ce stream soit envoyé dans la console.</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/stream_verbose01-3b89e014311cd892b3cb7f725800d008.png" width="632" height="173" class="img_ev3q"></p><p>On n&#x27;utilisera pas vraiment cette technique, par contre. La raison pour laquelle on souhaiterait utiliser la commande Write-Verbose dans un script est pour afficher des messages détaillés optionnels, et permettre à l&#x27;utilisateur qui appelle le script de spécifier en paramètre s&#x27;il veut afficher ces messages. PowerShell offre un mécanisme pour ça.</p><p>Tout d&#x27;abord, on doit &quot;transformer&quot; le script en cmdlet. PowerShell ajoute à toutes les commandes un certain nombre de paramètres: ce sont les <strong>paramètres communs</strong>. Simplement en ajoutant la mention <code>[CmdletBinding()]</code> au début du script, juste avant le bloc <code>param()</code>, le script ou la fonction importera ces paramètres communs.</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/stream_cmdletbinding01-d5d97c214f04e88656a0511778e3d6c8.png" width="676" height="243" class="img_ev3q"></p><p>Un des paramètres commun est le switch <code>-Verbose</code>, et lorsqu&#x27;on le spécifie, a pour effet d&#x27;activer la verbose pour le script.</p><p><img loading="lazy" src="/b64-scriptage-sous-windows/assets/images/stream_verbose02-5364e6ae11a4fea5480c26de6cdefd1b.png" width="483" height="314" class="img_ev3q"></p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>astuce</div><div class="admonitionContent_S0QG"><p>Si votre script est muni d&#x27;une fonction de logging, vous pouvez ajouter le même message, moins le <em>timestamp</em>, dans le stream Verbose à l&#x27;aide de la commande <code>Write-Verbose</code>. Vous ferez alors d&#x27;une pierre deux coups et ajouter ces deux opérations (l&#x27;écriture à un fichier et à la verbose) dans votre fonction de log.</p></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Pages de documentation"><a class="pagination-nav__link pagination-nav__link--prev" href="/b64-scriptage-sous-windows/cours/07"><div class="pagination-nav__sublabel">Précédent</div><div class="pagination-nav__label">R07 - Examen intra</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#psprovider-et-psdrive" class="table-of-contents__link toc-highlight"><em>PSProvider</em> et <em>PSDrive</em></a></li><li><a href="#le-registre-de-windows" class="table-of-contents__link toc-highlight">Le registre de Windows</a><ul><li><a href="#structure-du-registre" class="table-of-contents__link toc-highlight">Structure du registre</a></li><li><a href="#clés" class="table-of-contents__link toc-highlight">Clés</a></li><li><a href="#valeurs" class="table-of-contents__link toc-highlight">Valeurs</a></li><li><a href="#fichiers-du-registre" class="table-of-contents__link toc-highlight">Fichiers du registre</a></li><li><a href="#principales-racines" class="table-of-contents__link toc-highlight">Principales racines</a></li></ul></li><li><a href="#accès-au-registre-avec-powershell" class="table-of-contents__link toc-highlight">Accès au registre avec PowerShell</a><ul><li><a href="#obtenir-la-liste-des-sous-clés-dune-clé" class="table-of-contents__link toc-highlight">Obtenir la liste des sous-clés d&#39;une clé</a></li><li><a href="#tester-si-une-clé-existe" class="table-of-contents__link toc-highlight">Tester si une clé existe</a></li><li><a href="#créer-une-clé" class="table-of-contents__link toc-highlight">Créer une clé</a></li><li><a href="#effacer-une-clé" class="table-of-contents__link toc-highlight">Effacer une clé</a></li><li><a href="#obtenir-les-valeurs-dans-une-clé" class="table-of-contents__link toc-highlight">Obtenir les valeurs dans une clé</a></li><li><a href="#tester-si-une-valeur-existe" class="table-of-contents__link toc-highlight">Tester si une valeur existe</a></li><li><a href="#créer-une-valeur" class="table-of-contents__link toc-highlight">Créer une valeur</a></li><li><a href="#modifier-une-valeur-existante" class="table-of-contents__link toc-highlight">Modifier une valeur existante</a></li><li><a href="#effacer-une-valeur" class="table-of-contents__link toc-highlight">Effacer une valeur</a></li></ul></li><li><a href="#streams" class="table-of-contents__link toc-highlight">Streams</a><ul><li><a href="#stream-1-output--success" class="table-of-contents__link toc-highlight">Stream 1: Output / Success</a></li><li><a href="#stream-2-error" class="table-of-contents__link toc-highlight">Stream 2: Error</a></li><li><a href="#stream-3-warning" class="table-of-contents__link toc-highlight">Stream 3: Warning</a></li><li><a href="#stream-4-verbose" class="table-of-contents__link toc-highlight">Stream 4: Verbose</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Sources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/departement-info-cem/b64-scriptage-sous-windows" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Vincent Carrier. Tous droits réservés.</div></div></div></footer></div>
<script src="/b64-scriptage-sous-windows/assets/js/runtime~main.475f7794.js"></script>
<script src="/b64-scriptage-sous-windows/assets/js/main.d39d7ef7.js"></script>
</body>
</html>