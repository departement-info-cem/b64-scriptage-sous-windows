<!doctype html>
<html lang="fr" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-cours/r05">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">R05 - Gestion des comptes | 420-B64-EM - Scriptage sous Windows </title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://info.cegepmontpetit.ca/b64-scriptage-sous-windows/cours/05"><meta data-rh="true" name="docusaurus_locale" content="fr"><meta data-rh="true" name="docsearch:language" content="fr"><meta data-rh="true" name="keywords" content="420-B64-EM - Scriptage sous Windows , Site de référence du cours de scriptage sous Windows (formation continue), informatique, technique, cégep, cegep, édouard-montpetit, edouard-montpetit, édouard montpetit, edouard montpetit"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="R05 - Gestion des comptes | 420-B64-EM - Scriptage sous Windows "><meta data-rh="true" name="description" content="1. Rappel du cours précédent"><meta data-rh="true" property="og:description" content="1. Rappel du cours précédent"><link data-rh="true" rel="icon" href="/b64-scriptage-sous-windows/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://info.cegepmontpetit.ca/b64-scriptage-sous-windows/cours/05"><link data-rh="true" rel="alternate" href="https://info.cegepmontpetit.ca/b64-scriptage-sous-windows/cours/05" hreflang="fr"><link data-rh="true" rel="alternate" href="https://info.cegepmontpetit.ca/b64-scriptage-sous-windows/cours/05" hreflang="x-default"><link rel="stylesheet" href="/b64-scriptage-sous-windows/assets/css/styles.8f0fac2d.css">
<link rel="preload" href="/b64-scriptage-sous-windows/assets/js/runtime~main.93079054.js" as="script">
<link rel="preload" href="/b64-scriptage-sous-windows/assets/js/main.7ce15393.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Aller au contenu principal"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Aller au contenu principal</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Ouvrir/fermer la barre de navigation" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/b64-scriptage-sous-windows/"><div class="navbar__logo"><img src="/b64-scriptage-sous-windows/img/logo.svg" alt="Logo CEM" class="themedImage_ToTc themedImage--light_HNdA"><img src="/b64-scriptage-sous-windows/img/logo.svg" alt="Logo CEM" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">420-B64-EM - Scriptage sous Windows </b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/b64-scriptage-sous-windows/cours/01">Cours</a><a class="navbar__item navbar__link" href="/b64-scriptage-sous-windows/tutoriels/github-classroom-simple">Tutoriels</a><a class="navbar__item navbar__link" href="/b64-scriptage-sous-windows/tp/tp1">Travaux Pratiques</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-label="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Retour au début de la page" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/b64-scriptage-sous-windows/cours/01">R01 - Accueil</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/b64-scriptage-sous-windows/cours/02">R02 - Objets et pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/b64-scriptage-sous-windows/cours/03">R03 - Dictionnaires et scripts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/b64-scriptage-sous-windows/cours/04">R04 - Paramètres, fonctions, fichiers et strings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/b64-scriptage-sous-windows/cours/05">R05 - Gestion des comptes</a></li></ul></nav><button type="button" title="Réduire le menu latéral" aria-label="Réduire le menu latéral" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Fil d&#x27;Ariane"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Page d&#x27;accueil" class="breadcrumbs__link" href="/b64-scriptage-sous-windows/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">R05 - Gestion des comptes</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Sur cette page</button></div><div class="theme-doc-markdown markdown"><h1>Rencontre 5 - Gestion des comptes</h1><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Résumé de la séance</div><div class="admonitionContent_S0QG"><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">👨‍🏫 Déroulement du cours</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">💻 Exercices à compléter</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">📚 Ressources à consulter</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><ol><li>Rappel du cours précédent</li><li>Gestion des comptes locaux</li><li>Gestion des comptes de domaine</li><li>Git</li><li>Présentation du TP1</li></ol></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><ul><li>Travail pratique 1</li></ul></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>La présentation PowerPoint est sur le Teams du cours, sous le canal Général &gt; Fichiers &gt; Supports de cours.</p></div></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="gestion-des-comptes-locaux">Gestion des comptes locaux<a href="#gestion-des-comptes-locaux" class="hash-link" aria-label="Lien direct vers Gestion des comptes locaux" title="Lien direct vers Gestion des comptes locaux">​</a></h2><p>À l&#x27;exception des contrôleurs de domaine, toutes les machines Windows, qu&#x27;elles soient d&#x27;une édition client (Windows 10 / 11) ou serveur, possèdent des utilisateurs locaux. Comme vous l&#x27;avez vu dans le cours de systèmes d&#x27;exploitation, les utilisateurs locaux peuvent être gérés au moyen du composant enfichable &quot;Utilisateurs et groupes locaux&quot; dans une console MMC (accessible par lusrmgr.msc ou compmgmt.msc). Par défaut, lorsqu&#x27;on installe Windows, un certain nombre de comptes utilisateurs sont créés, dont <em>Administrateur</em> et <em>Invité</em>.</p><p>Windows possède également un ensemble de groupes locaux prédéfinis. On peut ajouter des comptes (locaux ou domaine) dans un groupe local. Certains groupes possèdent des privilèges particuliers, comme le groupe <strong>Administrateurs</strong>; tous les comptes utilisateurs membres de ce groupe disposent du <strong>privilège d&#x27;élévation</strong> (&quot;exécuter en tant qu&#x27;admin&quot;). Les membres du groupe <strong>Utilisateurs</strong>, quant à eux, disposent du privilège de <strong>démarrage de session locale</strong>. </p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>attention</div><div class="admonitionContent_S0QG"><p>Un utilisateur qui n&#x27;est pas membre d&#x27;un de ces groupes ne sera pas autorisé à démarrer une session.</p></div></div><p>On peut utiliser PowerShell pour contrôler les utilisateurs locaux, les groupes locaux ainsi que l&#x27;appartenance aux groupes locaux. PowerShell offre pour ce faire un module <code>Microsoft.PowerShell.LocalAccounts</code> qui renferme plusieurs commandes, notamment:</p><ul><li><code>Add-LocalGroupMember</code></li><li><code>Disable-LocalUser</code></li><li><code>Enable-LocalUser</code></li><li><code>Get-LocalGroup</code></li><li><code>Get-LocalGroupMember</code></li><li><code>Get-LocalUser</code></li><li><code>New-LocalGroup</code></li><li><code>New-LocalUser</code></li><li><code>Remove-LocalGroup</code></li><li><code>Remove-LocalGroupMember</code></li><li><code>Remove-LocalUser</code></li><li><code>Rename-LocalGroup</code></li><li><code>Rename-LocalUser</code></li><li><code>Set-LocalGroup</code></li><li><code>Set-LocalUser</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="consulter-les-utilisateurs-existants">Consulter les utilisateurs existants<a href="#consulter-les-utilisateurs-existants" class="hash-link" aria-label="Lien direct vers Consulter les utilisateurs existants" title="Lien direct vers Consulter les utilisateurs existants">​</a></h3><p>La commande Get-LocalUser permet d&#x27;obtenir la liste des utilisateurs locaux. Elle retourne un ou plusieurs objets de types <code>[Microsoft.PowerShell.Commands.LocalUser]</code> qui décrivent un compte utilisateur local.</p><div class="powerShellWindow_Gzoq"><div class="powerShellWindowHeader_KhXz"><div class="windowTitle_SU4_"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 204.691 154.521" style="enable-background:new 0 0 204.691 154.521" xml:space="preserve" class="logo_ViDu"><path style="fill-rule:evenodd;clip-rule:evenodd;fill:#e0eaf5" d="M120.14.032c23.011-.008 46.023-.078 69.034.019 13.68.056 17.537 4.627 14.588 18.137-8.636 39.566-17.466 79.092-26.415 118.589-2.83 12.484-9.332 17.598-22.465 17.637-46.023.137-92.046.152-138.068-.006-15.043-.053-19-5.148-15.759-19.404A39065.945 39065.945 0 0 1 27.602 18.892C30.997 4.148 36.099.1 51.104.057 74.116-.008 97.128.04 120.14.032z"></path><path style="fill-rule:evenodd;clip-rule:evenodd;fill:#2671be" d="M85.365 149.813c-23.014-.008-46.029.098-69.042-.053-11.67-.076-13.792-2.83-11.165-14.244 8.906-38.71 18.099-77.355 26.807-116.109C34.3 9.013 39.337 4.419 50.473 4.522c46.024.427 92.056.137 138.083.184 11.543.011 13.481 2.48 10.89 14.187-8.413 38.007-16.879 76.003-25.494 113.965-3.224 14.207-6.938 16.918-21.885 16.951-22.234.047-44.469.012-66.702.004z"></path><path style="fill-rule:evenodd;clip-rule:evenodd;fill:#fdfdfe" d="M104.948 73.951c-1.543-1.81-3.237-3.894-5.031-5.886-10.173-11.3-20.256-22.684-30.61-33.815-4.738-5.094-6.248-10.041-.558-15.069 5.623-4.97 11.148-4.53 16.306 1.188 14.365 15.919 28.713 31.856 43.316 47.556 5.452 5.864 4.182 9.851-1.823 14.196-23.049 16.683-45.968 33.547-68.862 50.443-5.146 3.799-10.052 4.75-14.209-.861-4.586-6.189-.343-9.871 4.414-13.335 17.013-12.392 33.993-24.83 50.9-37.366 2.355-1.746 5.736-2.764 6.157-7.051z"></path><path style="fill-rule:evenodd;clip-rule:evenodd;fill:#fcfdfd" d="M112.235 133.819c-6.196 0-12.401.213-18.583-.068-4.932-.223-7.9-2.979-7.838-8.174.06-4.912 2.536-8.605 7.463-8.738 13.542-.363 27.104-.285 40.651-.02 4.305.084 7.483 2.889 7.457 7.375-.031 5.146-2.739 9.133-8.25 9.465-6.944.42-13.931.104-20.899.104l-.001.056z"></path></svg>Windows PowerShell</div><div class="powerShellWindowAddressBar_gtm6"></div><div></div></div><div class="powerShellWindowBody_NigQ"><div class="firstLine_ulUJ">PS <!-- -->C:\<!-- -->&gt;<!-- --> Get-LocalUser<div class="spacer_qFME"></div><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn copyButton_HJ80"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div><pre class="codeContainer_ymgP"><code>
Name               Enabled Description 
----               ------- -----------
Administrateur     True    Compte d’utilisateur d’administration
DefaultAccount     False   Compte utilisateur géré par le système.
Invité             False   Compte d’utilisateur invité
paul               True    Boss de la compagnie
WDAGUtilityAccount False   Compte d’utilisateur géré et utilisé par le syst...</code></pre></div></div><p>Ces objets possèdent plusieurs informations sur le compte utilisateur. On peut les voir en explorant la structure de l&#x27;objet, par exemple avec <code>Select-Object *</code>.</p><div class="powerShellWindow_Gzoq"><div class="powerShellWindowHeader_KhXz"><div class="windowTitle_SU4_"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 204.691 154.521" style="enable-background:new 0 0 204.691 154.521" xml:space="preserve" class="logo_ViDu"><path style="fill-rule:evenodd;clip-rule:evenodd;fill:#e0eaf5" d="M120.14.032c23.011-.008 46.023-.078 69.034.019 13.68.056 17.537 4.627 14.588 18.137-8.636 39.566-17.466 79.092-26.415 118.589-2.83 12.484-9.332 17.598-22.465 17.637-46.023.137-92.046.152-138.068-.006-15.043-.053-19-5.148-15.759-19.404A39065.945 39065.945 0 0 1 27.602 18.892C30.997 4.148 36.099.1 51.104.057 74.116-.008 97.128.04 120.14.032z"></path><path style="fill-rule:evenodd;clip-rule:evenodd;fill:#2671be" d="M85.365 149.813c-23.014-.008-46.029.098-69.042-.053-11.67-.076-13.792-2.83-11.165-14.244 8.906-38.71 18.099-77.355 26.807-116.109C34.3 9.013 39.337 4.419 50.473 4.522c46.024.427 92.056.137 138.083.184 11.543.011 13.481 2.48 10.89 14.187-8.413 38.007-16.879 76.003-25.494 113.965-3.224 14.207-6.938 16.918-21.885 16.951-22.234.047-44.469.012-66.702.004z"></path><path style="fill-rule:evenodd;clip-rule:evenodd;fill:#fdfdfe" d="M104.948 73.951c-1.543-1.81-3.237-3.894-5.031-5.886-10.173-11.3-20.256-22.684-30.61-33.815-4.738-5.094-6.248-10.041-.558-15.069 5.623-4.97 11.148-4.53 16.306 1.188 14.365 15.919 28.713 31.856 43.316 47.556 5.452 5.864 4.182 9.851-1.823 14.196-23.049 16.683-45.968 33.547-68.862 50.443-5.146 3.799-10.052 4.75-14.209-.861-4.586-6.189-.343-9.871 4.414-13.335 17.013-12.392 33.993-24.83 50.9-37.366 2.355-1.746 5.736-2.764 6.157-7.051z"></path><path style="fill-rule:evenodd;clip-rule:evenodd;fill:#fcfdfd" d="M112.235 133.819c-6.196 0-12.401.213-18.583-.068-4.932-.223-7.9-2.979-7.838-8.174.06-4.912 2.536-8.605 7.463-8.738 13.542-.363 27.104-.285 40.651-.02 4.305.084 7.483 2.889 7.457 7.375-.031 5.146-2.739 9.133-8.25 9.465-6.944.42-13.931.104-20.899.104l-.001.056z"></path></svg>Windows PowerShell</div><div class="powerShellWindowAddressBar_gtm6"></div><div></div></div><div class="powerShellWindowBody_NigQ"><div class="firstLine_ulUJ">PS <!-- -->C:\<!-- -->&gt;<!-- --> Get-LocalUser -Name &#x27;paul&#x27; | Select-Object *<div class="spacer_qFME"></div><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn copyButton_HJ80"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div><pre class="codeContainer_ymgP"><code>
AccountExpires         : 2023-05-12 20:06:27
Description            : Boss de la compagnie
Enabled                : True
FullName               : Paul Meilleur
PasswordChangeableDate : 2023-04-13 20:06:27
PasswordExpires        : 2023-05-24 20:06:27
UserMayChangePassword  : True
PasswordRequired       : False
PasswordLastSet        : 2023-04-12 20:06:27
LastLogon              :
Name                   : paul
SID                    : S-1-5-21-3297567932-2200011671-69726474-1001
PrincipalSource        : Local
ObjectClass            : Utilisateur</code></pre></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="création-dun-nouvel-utilisateur">Création d&#x27;un nouvel utilisateur<a href="#création-dun-nouvel-utilisateur" class="hash-link" aria-label="Lien direct vers Création d&#x27;un nouvel utilisateur" title="Lien direct vers Création d&#x27;un nouvel utilisateur">​</a></h3><p>La commande <code>New-LocalUser</code> crée un utilisateur local et retourne l&#x27;objet décrivant cet utilisateur dans le pipeline (comme il est d&#x27;usage par la majorité des commandes exploitant le verbe <code>New-</code>). Il faut évidemment que la session PowerShell soit élevée en tant qu&#x27;admin pour apporter des modifications sur les utilisateurs locaux.</p><p>La commande offre un certains nombres de paramètres pour spécifier les différentes propriétés du compte à créer.</p><table><thead><tr><th>Paramètre</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Name</code></td><td>String</td><td>Le nom d&#x27;utilisateur (<em>login</em>)</td></tr><tr><td><code>FullName</code></td><td>String</td><td>Le nom complet (prénom nom)</td></tr><tr><td><code>Description</code></td><td>String</td><td>Le champ Description</td></tr><tr><td><code>AccountExpires</code></td><td>DateTime</td><td>La date d&#x27;expiration de l&#x27;utilisateur</td></tr><tr><td><code>AccountNeverExpires</code></td><td>Switch</td><td>Indique que le compte n&#x27;expire jamais</td></tr><tr><td><code>Disabled</code></td><td>Switch</td><td>Indique que le compte est désactivé dès sa création</td></tr><tr><td><code>Password</code></td><td>SecureString</td><td>Le mot de passe de l&#x27;utilisateur</td></tr><tr><td><code>NoPassword</code></td><td>Switch</td><td>Indique que le compte n&#x27;a aucun mot de passe (pas très sécuritaire!)</td></tr><tr><td><code>PasswordNeverExpires</code></td><td>Switch</td><td>Indique que le mot de passe n&#x27;expire jamais</td></tr><tr><td><code>UserMayNotChangePassword</code></td><td>Switch</td><td>Indique que l&#x27;utilisateur n&#x27;a pas le droit de modifier son mot de passe</td></tr><tr><td><code>WhatIf</code></td><td>Switch</td><td>Fait en sorte que la commande ne crée pas l&#x27;utilisateur pour vrai (utile pour tester)</td></tr></tbody></table><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>Le mot de passe est de type <code>[SecureString]</code> et pas une chaîne de caractères normale. Ce qui fait qu&#x27;on doit d&#x27;abord convertir la chaîne de caractère en chaîne sécurisée. On peut le faire au moyen de la commande <code>ConvertTo-SecureString</code>.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token variable" style="color:rgb(9, 134, 88)">$securepasswd</span><span class="token plain"> = </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Passw0rd&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">ConvertTo-SecureString</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">AsPlainText </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Force</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><p>Voici un exemple de création d&#x27;un compte utilisateur local (en utilisant le <em>splatting</em>):</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token variable" style="color:rgb(9, 134, 88)">$NouvelUtilisateurSplat</span><span class="token plain"> = @</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Name = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;paul&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    FullName = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Paul Meilleur&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Description = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Boss de la compagnie&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    AccountExpires = </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">Get-Date</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">AddDays</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">30</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">   </span><span class="token comment" style="color:rgb(0, 128, 0)"># Dans 30 jours</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Password = </span><span class="token function" style="color:rgb(0, 0, 255)">ConvertTo-SecureString</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">String </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Passw0rd&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">AsPlainText </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Force</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">New-LocalUser</span><span class="token plain"> @NouvelUtilisateurSplat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>On ne devrait jamais mettre des mots de passe en clair dans un script, ni stocker un mot de passe dans une variable en texte clair!!! Voici quelques options pour l&#x27;éviter:</p><ul><li>Créer un algorithme qui choisit automatiquement un mot de passe en fonction d&#x27;information provenant de l&#x27;extérieur</li><li>Utiliser la commande <code>Read-Host -AsSecureString</code> pour demander à l&#x27;utilisateur d&#x27;entrer un mot de passe (dont la saisie est masquée</li><li>Utiliser <code>Get-Credential</code> pour fournir un nom d&#x27;utilisateur et un mot de passe. Nous verrons plus loin cette commande lorsque nous traiterons de l&#x27;authentification par PowerShell.</li></ul></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="groupes-locaux">Groupes locaux<a href="#groupes-locaux" class="hash-link" aria-label="Lien direct vers Groupes locaux" title="Lien direct vers Groupes locaux">​</a></h3><p>À l&#x27;instar des utilisateurs, on peut connaître les groupes locaux au moyen de la commande <code>Get-LocalGroup</code>.</p><p>Pour créer un groupe local, on utilise la commande <code>New-LocalGroup</code>. Là encore, cette commande ne fonctionne que dans une session PowerShell élevée.</p><p>Pour obtenir les membres d&#x27;un groupe, on peut utiliser la commande <code>Get-LocalGroupMember</code>.</p><div class="powerShellWindow_Gzoq"><div class="powerShellWindowHeader_KhXz"><div class="windowTitle_SU4_"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 204.691 154.521" style="enable-background:new 0 0 204.691 154.521" xml:space="preserve" class="logo_ViDu"><path style="fill-rule:evenodd;clip-rule:evenodd;fill:#e0eaf5" d="M120.14.032c23.011-.008 46.023-.078 69.034.019 13.68.056 17.537 4.627 14.588 18.137-8.636 39.566-17.466 79.092-26.415 118.589-2.83 12.484-9.332 17.598-22.465 17.637-46.023.137-92.046.152-138.068-.006-15.043-.053-19-5.148-15.759-19.404A39065.945 39065.945 0 0 1 27.602 18.892C30.997 4.148 36.099.1 51.104.057 74.116-.008 97.128.04 120.14.032z"></path><path style="fill-rule:evenodd;clip-rule:evenodd;fill:#2671be" d="M85.365 149.813c-23.014-.008-46.029.098-69.042-.053-11.67-.076-13.792-2.83-11.165-14.244 8.906-38.71 18.099-77.355 26.807-116.109C34.3 9.013 39.337 4.419 50.473 4.522c46.024.427 92.056.137 138.083.184 11.543.011 13.481 2.48 10.89 14.187-8.413 38.007-16.879 76.003-25.494 113.965-3.224 14.207-6.938 16.918-21.885 16.951-22.234.047-44.469.012-66.702.004z"></path><path style="fill-rule:evenodd;clip-rule:evenodd;fill:#fdfdfe" d="M104.948 73.951c-1.543-1.81-3.237-3.894-5.031-5.886-10.173-11.3-20.256-22.684-30.61-33.815-4.738-5.094-6.248-10.041-.558-15.069 5.623-4.97 11.148-4.53 16.306 1.188 14.365 15.919 28.713 31.856 43.316 47.556 5.452 5.864 4.182 9.851-1.823 14.196-23.049 16.683-45.968 33.547-68.862 50.443-5.146 3.799-10.052 4.75-14.209-.861-4.586-6.189-.343-9.871 4.414-13.335 17.013-12.392 33.993-24.83 50.9-37.366 2.355-1.746 5.736-2.764 6.157-7.051z"></path><path style="fill-rule:evenodd;clip-rule:evenodd;fill:#fcfdfd" d="M112.235 133.819c-6.196 0-12.401.213-18.583-.068-4.932-.223-7.9-2.979-7.838-8.174.06-4.912 2.536-8.605 7.463-8.738 13.542-.363 27.104-.285 40.651-.02 4.305.084 7.483 2.889 7.457 7.375-.031 5.146-2.739 9.133-8.25 9.465-6.944.42-13.931.104-20.899.104l-.001.056z"></path></svg>Windows PowerShell</div><div class="powerShellWindowAddressBar_gtm6"></div><div></div></div><div class="powerShellWindowBody_NigQ"><div class="firstLine_ulUJ">PS <!-- -->C:\<!-- -->&gt;<!-- --> Get-LocalGroupMember -Group &#x27;Administrateurs&#x27;<div class="spacer_qFME"></div><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn copyButton_HJ80"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div><pre class="codeContainer_ymgP"><code>
ObjectClass Name                    PrincipalSource
----------- ----                    ---------------
Utilisateur PC0001\Administrateur   Local
Utilisateur PC0001\bob              Local
Utilisateur PC0001\paul             Local
Utilisateur PC0001\pierre           Local
Groupe      MINOU\Admins du domaine ActiveDirectory
Utilisateur MINOU\paul.meilleur     ActiveDirectory</code></pre></div></div><p>Pour ajouter un utilisateur dans un groupe, on utilise la commande <code>Add-LocalGroupMember</code>. Cette commande prend en paramètre <code>-Member</code> qui désigne le membre à ajouter, ainsi que <code>-Group</code> qui désigne le groupe dans lequel l&#x27;ajouter.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Add-LocalGroupMember</span><span class="token plain"> –Member </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Paul&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token function" style="color:rgb(0, 0, 255)">Group</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Administrateurs&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Cette commande admet qu&#x27;on passe le membre à ajouter par le pipeline en entrée.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-LocalUser</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Name </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Paul&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Add-LocalGroupMember</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token function" style="color:rgb(0, 0, 255)">Group</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Administrateurs&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Cela permet, entre autres, de créer un compte et l&#x27;ajouter immédiatement à un groupe, puisque la création génère un objet représentant l&#x27;utilisateur.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">New-LocalUser</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Name </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Zoe&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">NoPassword </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Add-LocalGroupMember</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token function" style="color:rgb(0, 0, 255)">Group</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Utilisateurs&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>On peut aussi ajouter des utilisateurs ou des groupes du domaine comme membre d&#x27;un groupe local. Pour ce faire, on n&#x27;a qu&#x27;à spécifier le sAMAccountName du principal de sécurité du domaine. Si la machine dispose d&#x27;une relation d&#x27;approbation avec le domaine du compte, celui-ci sera ajouté comme membre au groupe.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Add-LocalGroupMember</span><span class="token plain"> –Member </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;DOMAINE\paul.meilleur&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token function" style="color:rgb(0, 0, 255)">Group</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Administrateurs&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>astuce</div><div class="admonitionContent_S0QG"><p>Le nom des groupes est différent sur les versions anglaise et française de Windows. Pour que le script fonctionne indépendamment de la langue du système, on peut utiliser le SID du groupe plutôt que son nom. Le SID est un numéro d&#x27;identification unique, et dans le cas des groupes prédéfinis dans Windows (Administrateurs, Utilisateurs), il est toujours le même peu importe la langue.</p><p>On peut voir les SID des groupes avec la commande suivante:</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-LocalGroup</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Select-Object</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Property Name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> SID</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Voici quelques SID bien connus:</p><table><thead><tr><th>Nom français</th><th>Nom anglais</th><th>SID</th></tr></thead><tbody><tr><td>Administrateurs</td><td>Administrators</td><td><code>S-1-5-32-544</code></td></tr><tr><td>Utilisateurs</td><td>Users</td><td><code>S-1-5-32 545</code></td></tr></tbody></table><p>Par exemple, pour ajouter un utilisateur au groupe des administrateurs:</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token variable" style="color:rgb(9, 134, 88)">$MonUtilisateur</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Add-LocalGroupMember</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">SID </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;S-1-5-32-544&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="gestion-des-comptes-du-domaine">Gestion des comptes du domaine<a href="#gestion-des-comptes-du-domaine" class="hash-link" aria-label="Lien direct vers Gestion des comptes du domaine" title="Lien direct vers Gestion des comptes du domaine">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="outils-rsat">Outils RSAT<a href="#outils-rsat" class="hash-link" aria-label="Lien direct vers Outils RSAT" title="Lien direct vers Outils RSAT">​</a></h3><p>Lorsqu&#x27;on fait la promotion d&#x27;un serveur Windows en contrôleur de domaine, les outils d&#x27;administration d&#x27;Active Directory s&#x27;installent automatiquement sur cette machine. Les outils d&#x27;administration AD font partie d&#x27;une collection de consoles MMC connue sous le nom de RSAT (Remote Server Administration Tools).</p><p>Il existe plusieurs outils RSAT, qui sont normalement activés lorsqu&#x27;on installe le rôle ou la fonctionnalité sur un serveur, afin d&#x27;être utilisés localement sur ce serveur. Ce sont des composants optionnels de Windows, qui sont prêts à être installés lorsque nécessaire. Ainsi, la console RSAT DNS est installée automatiquement sur un serveur lorsqu&#x27;on active le rôle DNS, et la console DHCP s&#x27;installe automatiquement sur un serveur DHCP, etc. On n&#x27;est pas obligé d&#x27;installer toutes les consoles RSAT, seulement celles dont on a besoin.</p><p>Lorsqu&#x27;on installe un rôle (par exemple, Active Directory Domain Services), les consoles pour AD s&#x27;installent automatiquement. Mais il arrive qu&#x27;on souhaite installer une console RSAT sur une machine pour l&#x27;administration à distance. On peut donc installer les consoles indépendamment, ce qui nous permet d&#x27;utiliser ce serveur pour administrer un service hébergé sur un autre serveur.</p><p>Par exemple, il est rare que les administrateurs AD démarrent une session interactive RDP ou locale sur un contrôleur de domaine pour y créer des utilisateurs. Ce n&#x27;est pas une bonne pratique. Généralement, les administrateurs vont opérer la console sur une autre machine, soit leur poste de travail ou sur un serveur tiers qu&#x27;on qualifie de &quot;jump station&quot;.</p><p>Les consoles qui font partie des outils RSAT pour Active Directory sont:</p><ul><li>Active Directory Users and Computers (dsa.msc)</li><li>Active Directory Sites and Services (dssite.msc)</li><li>Active Directory Domains and Trusts (domain.msc)</li><li>ADSIEdit (adsiedit.msc)</li><li>Active Directory Administrative Center (dsac.exe)</li><li>Group Policy Managament Tool (gpmc.msc)</li></ul><p>Lorsqu&#x27;on installe les outils RSAT pour Active Directory, un module PowerShell pour manipuler Active Directory s&#x27;installe également. On peut utiliser ce module pour accéder à des commandes PowerShell utilisable dans nos scripts pour automatiser ce que nous ferions normalement à la main via les consoles MMC. Les outils RSAT installés sont exposés via l&#x27;élément Administrative Tools du menu Démarrer ou du vieux panneau de configuration de Windows (control.exe).</p><p>Les procédures et les commandes pour installer les outils RSAT ne sont pas les mêmes pour les éditions client et serveur de Windows.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="installer-rsat-sous-windows-server">Installer RSAT sous Windows Server<a href="#installer-rsat-sous-windows-server" class="hash-link" aria-label="Lien direct vers Installer RSAT sous Windows Server" title="Lien direct vers Installer RSAT sous Windows Server">​</a></h4><p>Sur un serveur Windows, par défaut, lorsqu&#x27;on installe un rôle ou une fonctionnalité, les outils RSAT correspondants s&#x27;installent aussi. Pour installer un outil RSAT sans installer le rôle ou la fonctionnalité, on peut utiliser les commandes dont le nom est <em>WindowsFeature</em>.</p><p>La commande <code>Get-WindowsFeature</code> permet d&#x27;obtenir la liste des rôles et fonctionnalités (dans la même liste, contrairement à l&#x27;interface graphique). Chaque fonctionnalité a son nom qui respecte une convention de nommage, et toutes les consoles d&#x27;administrations commencent par le préfixe RSAT (à l&#x27;exception de la console de gestion des stratégies de groupe).</p><p>Pour voir tous les outils d&#x27;administration disponibles, on peut lancer:</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-WindowsFeature</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Name </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;RSAT-*&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;GPMC&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Pour installer toutes les consoles de gestion pour Active Directory DS, y compris la console de gestion des stratégies de groupe (GPMC) et le module PowerShell, lancez la commande suivante:</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Install-WindowsFeature</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Name RSAT-AD-Tools</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> GPMC </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">IncludeAllSubFeature</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="installer-rsat-sous-windows-1011">Installer RSAT sous Windows 10/11<a href="#installer-rsat-sous-windows-1011" class="hash-link" aria-label="Lien direct vers Installer RSAT sous Windows 10/11" title="Lien direct vers Installer RSAT sous Windows 10/11">​</a></h4><p>Sur un client Windows, les outils RSAT sont considérés comme des composants optionnels, aussi appelés &quot;Feature-on-Demand&quot;, qui peuvent être installés à la demande. Contrairement aux serveurs, les éditions clientes de Windows doivent télécharger les composants RSAT d&#x27;Internet sur les serveurs de mises à jour de Microsoft.</p><p>Pour gérer ces composants optionnels, on peut utiliser les commande PowerShell dont le nom est &quot;WindowsCapability&quot;.</p><p>Pour installer toutes les consoles de gestion pour Active Directory DS, y compris la console de gestion des stratégies de groupe (GPMC) et le module PowerShell, lancez la commande suivante:</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-WindowsCapability</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Online </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Where-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$_</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">Name </span><span class="token operator" style="color:rgb(0, 0, 0)">-Match</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;^rsat\.activedirectory|grouppolicy.*$&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Add-WindowsCapability</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Online</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="module-powershell-pour-adds">Module PowerShell pour ADDS<a href="#module-powershell-pour-adds" class="hash-link" aria-label="Lien direct vers Module PowerShell pour ADDS" title="Lien direct vers Module PowerShell pour ADDS">​</a></h4><p>Les outils RSAT pour administrer Active Directory comprennent un module PowerShell qui offre une panoplie de commandes pour contrôler AD.</p><p>Pour l&#x27;utiliser, il faut importer le module.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Import-Module</span><span class="token plain"> ActiveDirectory</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>Il n&#x27;est pas nécessaire d&#x27;exécuter ces commandes à partir d&#x27;un contrôleur de domaine. En fait, il est préférable de le faire à partir d&#x27;un autre ordinateur, pourvu qu&#x27;il soit membre du domaine. C&#x27;est le compte utilisé pour lancer les commandes qui importe, pas la machine sur laquelle elles sont lancées.</p></div></div><p>On peut ensuite lister toutes les commandes qui sont offertes par ce module.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-Command</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Module ActiveDirectory</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On peut vérifier les modules installés qui sont disponibles pour être importés. Pour vérifier quels modules sont importés dans la session PowerShell en cours, on utilise la commande <code>Get-Module</code>.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-Module</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ListAvailable</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Pour charger le module Active Directory dans un script, on doit lancer la commande <code>Import-Module</code> au début du script (plus précisément, avant de lancer toute commande de ce module).</p><p>Il est aussi recommandé d&#x27;ajouter une instruction <code>#Requires</code>, pour faire planter le script automatiquement avant même le début de son exécution si le module Active Directory n&#x27;est pas installé. On évite ainsi des erreurs plus tard dans le script.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">#Requires -Module ActiveDirectory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Import-Module</span><span class="token plain"> ActiveDirectory</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Plus de détails sur l&#x27;instruction <code>#Requires</code> ici: <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_requires?view=powershell-5.1" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_requires?view=powershell-5.1</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="informations-sur-le-domaine-et-la-forêt">Informations sur le domaine et la forêt<a href="#informations-sur-le-domaine-et-la-forêt" class="hash-link" aria-label="Lien direct vers Informations sur le domaine et la forêt" title="Lien direct vers Informations sur le domaine et la forêt">​</a></h3><p>Les commandes <code>Get-ADDomain</code> et <code>Get-ADForest</code> permettent d&#x27;obtenir de l&#x27;information sur le domaine et la forêt respectivement, tels que le niveau fonctionnel, les contrôleurs de domaine qui disposent d&#x27;un rôle FSMO, les conteneurs par défaut, le SID du domaine, la topologie des sites, etc.</p><p><a target="_blank" href="/b64-scriptage-sous-windows/assets/files/get-addomain-d02e125e71d85250b8715dd59bdfb2ef.png">Get-ADDomain</a></p><p>Une information intéressante est celle du contexte de nom par défaut (<em>Default Naming Context</em>). Il équivaut à la partie domaine à la fin des noms distinctifs des objets dans le domaine. On peut l&#x27;obtenir à l&#x27;aide de la commande <code>Get-RootDSE</code>.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">Get-ADRootDSE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">defaultNamingContext</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="unités-dorganisation">Unités d&#x27;organisation<a href="#unités-dorganisation" class="hash-link" aria-label="Lien direct vers Unités d&#x27;organisation" title="Lien direct vers Unités d&#x27;organisation">​</a></h3><p>Les unités d&#x27;organisation (<em>Organizational Unit</em>, ou <em>OU</em>) sont des conteneurs dans lesquels on peut disposer des objets du domaine et sur lesquels on peut lier des stratégies de groupe (GPO). Ce ne sont pas tous les conteneurs qui sont des unités d&#x27;organisation; ces dernières portent le préfixe <code>OU=</code> dans leur nom distinctif relatif.</p><p><img loading="lazy" alt="Unités d&amp;#39;organisation" src="/b64-scriptage-sous-windows/assets/images/ad-ou-03ce79587dea7cb195b3e545ee00049e.png" width="343" height="330" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="recherche-dune-unité-dorganisation">Recherche d&#x27;une unité d&#x27;organisation<a href="#recherche-dune-unité-dorganisation" class="hash-link" aria-label="Lien direct vers Recherche d&#x27;une unité d&#x27;organisation" title="Lien direct vers Recherche d&#x27;une unité d&#x27;organisation">​</a></h4><p>Pour obtenir de l&#x27;information sur une unité d&#x27;organisation spécifique, on peut utiliser la commande <code>Get-ADOrganizationalUnit</code> en lui fournissant le nom distinctif (DN) de l&#x27;unité d&#x27;organisation.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-ADOrganizationalUnit</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Identity </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;OU=Laptops,DC=ad,DC=mondomaine,DC=com&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On peut obtenir la liste de toutes les unités d&#x27;organisation du domaine en spécifiant le filtre *</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-ADOrganizationalUnit</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token keyword" style="color:rgb(0, 0, 255)">Filter</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Format-Table</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="création-dune-unité-dorganisation">Création d&#x27;une unité d&#x27;organisation<a href="#création-dune-unité-dorganisation" class="hash-link" aria-label="Lien direct vers Création d&#x27;une unité d&#x27;organisation" title="Lien direct vers Création d&#x27;une unité d&#x27;organisation">​</a></h4><p>Pour créer une unité d&#x27;organisation dans un domaine, on utilise la commande <code>New-ADOrganizationalUnit</code> en lui spécifiant le nom de l&#x27;OU à créer ainsi que le nom distinctif complet du conteneur parent.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token variable" style="color:rgb(9, 134, 88)">$ADOrganizationalUnitSplat</span><span class="token plain"> = @</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Name = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Laptops&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Path = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;OU=Laptops,DC=ad,DC=mondomaine,DC=com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">New-ADOrganizationalUnit</span><span class="token plain"> @ADOrganizationalUnitSplat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>La commande <code>New-ADOrganizationalUnit</code> ne retourne pas d&#x27;objet par défaut dans le pipeline. Pour qu&#x27;elle en retourne un, on n&#x27;a qu&#x27;à lui passer le switch <code>-PassThru</code>.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">New-ADOrganizationalUnit</span><span class="token plain"> @ADOrganizationalUnitSplat </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">PassThru</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="comptes-utilisateurs">Comptes utilisateurs<a href="#comptes-utilisateurs" class="hash-link" aria-label="Lien direct vers Comptes utilisateurs" title="Lien direct vers Comptes utilisateurs">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="recherche-dun-compte-utilisateur">Recherche d&#x27;un compte utilisateur<a href="#recherche-dun-compte-utilisateur" class="hash-link" aria-label="Lien direct vers Recherche d&#x27;un compte utilisateur" title="Lien direct vers Recherche d&#x27;un compte utilisateur">​</a></h4><p>Pour rechercher un utilisateur dans Active Directory, la commande à utiliser est <code>Get-ADUser</code>.</p><p>Pour rechercher un utilisateur spécifique, on peut spécifier le paramètre <code>-Identity</code>. Ce paramètre peut admettre comme valeur le nom d&#x27;utilisateur court (sAMAccountName), le nom distinctif (DN), le SID ou le GUID.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-ADUser</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Identity </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;zzappa&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Pour rechercher les utilisateurs obéissant à certains critères, on peut utiliser le paramètre <code>-Filter</code>.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-ADUser</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token keyword" style="color:rgb(0, 0, 255)">Filter</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sAMAccountName -like &quot;z*&quot;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="vérification-de-lexistence-dun-compte-utilisateur">Vérification de l&#x27;existence d&#x27;un compte utilisateur<a href="#vérification-de-lexistence-dun-compte-utilisateur" class="hash-link" aria-label="Lien direct vers Vérification de l&#x27;existence d&#x27;un compte utilisateur" title="Lien direct vers Vérification de l&#x27;existence d&#x27;un compte utilisateur">​</a></h4><p>Pour tester l&#x27;existence d&#x27;un utilisateur dans le domaine, voici un exemple:</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">Get-ADUser</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token keyword" style="color:rgb(0, 0, 255)">Filter</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sAMAccountName -eq &quot;zzappa&quot;&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;L&#x27;utilisateur existe.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;L&#x27;utilisateur n&#x27;existe pas.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="création-dun-nouveau-compte-utilisateur">Création d&#x27;un nouveau compte utilisateur<a href="#création-dun-nouveau-compte-utilisateur" class="hash-link" aria-label="Lien direct vers Création d&#x27;un nouveau compte utilisateur" title="Lien direct vers Création d&#x27;un nouveau compte utilisateur">​</a></h4><p>Pour créer un nouvel utilisateur, on peut utiliser la commande <code>New-ADUser</code>. Étant donné la quantité d&#x27;attributs disponibles dans les objets utilisateurs, cette commande admet un très grand nombre d&#x27;arguments. Voici un exemple de création d&#x27;un compte utilisateur (la plupart de ces attributs sont facultatifs; en fait, seul le paramètre <code>Name</code> est obligatoire).</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token variable" style="color:rgb(9, 134, 88)">$ADUserSplat</span><span class="token plain"> = @</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Path = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;OU=Utilisateurs,DC=ad,DC=mondomaine,DC=com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Name = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Zoe Zappa&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    GivenName = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Zoé&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Surname = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Zappa&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Initials = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Z.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Title = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Dr.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    DisplayName = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Dr. Zoé Zappa, Ph.D.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Description = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;VP de chépoquoi&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SamAccountName = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;zzappa&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    UserPrincipalName = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;zzappa@ad.mondomaine.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    AccountPassword = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Passw0rd&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">ConvertTo-SecureString</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">AsPlainText </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Force</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ChangePasswordAtLogon = </span><span class="token boolean">$true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    StreetAddress = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;42 rue des timinous&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    City = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Minoupolis&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Country = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;CA&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    PostalCode = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;H0H 0H0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    MobilePhone = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;(555) 555-5555&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    EmployeeNumber = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;2546011&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    EmailAddress = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;zzappa@mondomaine.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Enabled = </span><span class="token boolean">$true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">New-ADUser</span><span class="token plain"> @ADUserSplat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Vous pouvez consulter la liste des paramètres de cette commande sur <a href="https://learn.microsoft.com/fr-ca/powershell/module/activedirectory/new-aduser" target="_blank" rel="noopener noreferrer">sa page de documentation</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="modification-dun-compte-utilisateur-existant">Modification d&#x27;un compte utilisateur existant<a href="#modification-dun-compte-utilisateur-existant" class="hash-link" aria-label="Lien direct vers Modification d&#x27;un compte utilisateur existant" title="Lien direct vers Modification d&#x27;un compte utilisateur existant">​</a></h4><p>On peut utiliser la commande <code>Set-ADUser</code> pour modifier un attribut d&#x27;un compte utilisateur existant. L&#x27;exemple suivant modifie l&#x27;adresse courriel de l&#x27;utilisateur Bob.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token variable" style="color:rgb(9, 134, 88)">$ADSetUserSplat</span><span class="token plain"> = @</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Identity = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Bob&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    EmailAddress = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;bob@mondomaine.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Set-ADUser</span><span class="token plain"> @ADSetUserSplat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="suppression-dun-compte-utilisateur">Suppression d&#x27;un compte utilisateur<a href="#suppression-dun-compte-utilisateur" class="hash-link" aria-label="Lien direct vers Suppression d&#x27;un compte utilisateur" title="Lien direct vers Suppression d&#x27;un compte utilisateur">​</a></h4><p>On peut utiliser la commande <code>Remove-ADUser</code> pour supprimer un compte utilisateur. Voici un exemple en lui passant un compte utilisateur par le pipeline.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-ADUser</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Identity </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;zzappa&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Remove-ADUser</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>astuce</div><div class="admonitionContent_S0QG"><p>Dans son comportement par défaut, <code>Remove-ADUser</code> demande une confirmation. Pour rendre l&#x27;opération complètement automatique, on peut désactiver le switch <code>-Confirm</code>, qui est activé par défaut (étrangement).</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Remove-ADUser</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Identity </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;zzappa&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Confirm:</span><span class="token boolean">$false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="groupes">Groupes<a href="#groupes" class="hash-link" aria-label="Lien direct vers Groupes" title="Lien direct vers Groupes">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="recherche-dun-groupe">Recherche d&#x27;un groupe<a href="#recherche-dun-groupe" class="hash-link" aria-label="Lien direct vers Recherche d&#x27;un groupe" title="Lien direct vers Recherche d&#x27;un groupe">​</a></h4><p>Pour obtenir de l&#x27;information sur un groupe, on peut utiliser la commande <code>Get-ADGroup</code>. Cette commande s&#x27;emploie de la même manière que pour les utilisateurs.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-ADGroup</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Identity </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Comptables&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Le paramètre <code>-Identity</code> peut admettre le nom du compte (<em>sAMAccountName</em>) mais aussi son <em>SID</em>, son <em>GUID</em> ou son nom distinctif (<em>DN</em>).</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-ADGroup</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Identity </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;CN=Comptables,OU=Groupes,DC=ad,DC=mondomaine,DC=com&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="vérification-de-lexistence-dun-groupe">Vérification de l&#x27;existence d&#x27;un groupe<a href="#vérification-de-lexistence-dun-groupe" class="hash-link" aria-label="Lien direct vers Vérification de l&#x27;existence d&#x27;un groupe" title="Lien direct vers Vérification de l&#x27;existence d&#x27;un groupe">​</a></h4><p>Pour vérifier si un groupe existe, on peut employer la même logique que pour les utilisateurs.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">Get-ADGroup</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token keyword" style="color:rgb(0, 0, 255)">Filter</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sAMAccountName -eq &quot;Comptables&quot;&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;L&#x27;utilisateur existe.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;L&#x27;utilisateur n&#x27;existe pas.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="création-dun-nouveau-groupe">Création d&#x27;un nouveau groupe<a href="#création-dun-nouveau-groupe" class="hash-link" aria-label="Lien direct vers Création d&#x27;un nouveau groupe" title="Lien direct vers Création d&#x27;un nouveau groupe">​</a></h4><p>Pour créer un nouveau groupe, voici un exemple. Il faut minimalement spécifier son nom, sa portée (global, domaine local ou universel) ainsi que le nom distinctif complet du conteneur dans lequel le créer.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token variable" style="color:rgb(9, 134, 88)">$ADGroupSplat</span><span class="token plain"> = @</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Name = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Gestionnaires&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    GroupScope = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Global&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Path = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;OU=Groupes,DC=ad,DC=mondomaine,DC=com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">New-ADGroup</span><span class="token plain"> @ADGroupSplat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="membres-de-groupes">Membres de groupes<a href="#membres-de-groupes" class="hash-link" aria-label="Lien direct vers Membres de groupes" title="Lien direct vers Membres de groupes">​</a></h3><p>Un groupe possède des membres, qui peuvent être soit des utilisateurs, des ordinateurs ou d&#x27;autres groupes. On nomme ces objets des <em>principaux de sécurité</em>. </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="obtention-des-membres-dun-groupe">Obtention des membres d&#x27;un groupe<a href="#obtention-des-membres-dun-groupe" class="hash-link" aria-label="Lien direct vers Obtention des membres d&#x27;un groupe" title="Lien direct vers Obtention des membres d&#x27;un groupe">​</a></h4><p>Pour consulter quels principaux de sécurité sont membres d&#x27;un groupe spécifique, voici un exemple:</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-ADGroupMember</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Identity </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Comptables&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On peut aussi passer un groupe par le pipeline.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-ADGroup</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Identity </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Comptables&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Get-ADGroupMember</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ajout-de-membres-à-un-groupe">Ajout de membres à un groupe<a href="#ajout-de-membres-à-un-groupe" class="hash-link" aria-label="Lien direct vers Ajout de membres à un groupe" title="Lien direct vers Ajout de membres à un groupe">​</a></h4><p>Pour ajouter un utilisateur à un groupe, voici un exemple:</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Add-ADGroupMember</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Identity </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Admins du domaine&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Members </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;zzappa&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On peut également ajouter un autre type de principal de sécurité, comme un compte ordinateur ou un groupe. Le procédé est alors exactement le même; il suffit de donner le nom du groupe ou de l&#x27;ordinateur dans l&#x27;argument <code>-Members</code>. Par ailleurs, puisque le paramètre <code>-Members</code> admet un tableau, il est possible de lui passer un tableaux de membres, qui seront tous ajoutés d&#x27;un coup au groupe.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="retrait-de-membres-à-un-groupe">Retrait de membres à un groupe<a href="#retrait-de-membres-à-un-groupe" class="hash-link" aria-label="Lien direct vers Retrait de membres à un groupe" title="Lien direct vers Retrait de membres à un groupe">​</a></h4><p>Pour retirer un compte d&#x27;un groupe, il suffit d&#x27;utiliser cette commande:</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Remove-ADGroupMember</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Identity </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Admins du domaine&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Members </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;zzappa&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>astuce</div><div class="admonitionContent_S0QG"><p>Pour éviter de dépendre de la langue du système et de la traduction de ses noms de groupes, on peut utiliser le SID des groupes bien connus, comme le groupe des admins du domaine.</p><p>Le SID du groupe des admins du domaine est constitué du SID du domaine suivi du RID 512. Ainsi, voici comment on peut le trouver dynamiquement.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token variable" style="color:rgb(9, 134, 88)">$DomainSID</span><span class="token plain"> = </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">Get-ADDomain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">DomainSID</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">Value</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$DomainAdminSID</span><span class="token plain"> = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token string variable" style="color:rgb(9, 134, 88)">$DomainSID</span><span class="token string" style="color:rgb(163, 21, 21)">-512&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Add-ADGroupMember</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Identity </span><span class="token variable" style="color:rgb(9, 134, 88)">$DomainAdminSID</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Members </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;zzappa&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="attributs">Attributs<a href="#attributs" class="hash-link" aria-label="Lien direct vers Attributs" title="Lien direct vers Attributs">​</a></h3><p>Lorsqu&#x27;on utilise des commandes <em>Get</em> comme <code>Get-ADUser</code> ou <code>Get-ADComputer</code>, ce ne sont pas tous les attributs des objets qui sont interrogés, et ce, même si on le passe dans un <code>Select-Object *</code>. Pour interroger un attribut qui ne l&#x27;est pas par défaut, il faut le spécifier au moyen du paramètre <code>-Properties</code>.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Get-ADUser</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Identity </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;zzappa&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Properties </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Par exemple, pour obtenir la date de création, on peut ajouter la propriété <code>Created</code>, qui n&#x27;est pas incluse dans l&#x27;objet par défaut.</p><p><img loading="lazy" alt="Get-ADUser -Identity &amp;quot;zzappa&amp;quot; -Properties Created" src="/b64-scriptage-sous-windows/assets/images/aduser-properties-d93f1f6f89d0f2c4530ee21fce5769c3.png" width="778" height="312" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="outils-supplémentaires">Outils supplémentaires<a href="#outils-supplémentaires" class="hash-link" aria-label="Lien direct vers Outils supplémentaires" title="Lien direct vers Outils supplémentaires">​</a></h3><p>Pour parcourir graphiquement les attributs des objets, on peut utiliser divers outils.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="fonctionnalités-avancées-de-la-console-aduc">Fonctionnalités avancées de la console ADUC<a href="#fonctionnalités-avancées-de-la-console-aduc" class="hash-link" aria-label="Lien direct vers Fonctionnalités avancées de la console ADUC" title="Lien direct vers Fonctionnalités avancées de la console ADUC">​</a></h4><p>Tout d&#x27;abord, la console Utilisateurs et ordinateurs Active Directory (<em>dsa.msc</em>) offre un onglet <strong>Éditeur d&#x27;attributs</strong>. Il n&#x27;est pas visible par défaut; il faut d&#x27;abord activer les <strong>fonctionnalités avancées</strong> de la console via le menu <strong>Affichage</strong>.</p><p><img loading="lazy" alt="ADUC Fonctionnalités avancées" src="/b64-scriptage-sous-windows/assets/images/aduc-advanced-342cb28ee1d33820baec6506efbc8e57.png" width="631" height="339" class="img_ev3q"> </p><p><img loading="lazy" alt="ADUC Éditeur d&amp;#39;attributs" src="/b64-scriptage-sous-windows/assets/images/aduc-attributeeditor-c3a36542280c8f846dcbfd4959642e5f.png" width="503" height="295" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="adsi-edit">ADSI Edit<a href="#adsi-edit" class="hash-link" aria-label="Lien direct vers ADSI Edit" title="Lien direct vers ADSI Edit">​</a></h4><p>Il existe également un autre outil provenant des outils RSAT: l&#x27;outil de modification ADSI (adsiedit.msc). Il permet de parcourir la base de données LDAP du domaine et permet un meilleur contrôle du domaine, à plus bas niveau. </p><p><img loading="lazy" alt="ADSI Edit" src="/b64-scriptage-sous-windows/assets/images/adsiedit-attributeeditor-d8b389317cb443f92ea177b96dcad684.png" width="528" height="436" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="adexplorer-sysinternals">ADExplorer (Sysinternals)<a href="#adexplorer-sysinternals" class="hash-link" aria-label="Lien direct vers ADExplorer (Sysinternals)" title="Lien direct vers ADExplorer (Sysinternals)">​</a></h4><p>Finalement, l&#x27;outil <a href="https://learn.microsoft.com/fr-ca/sysinternals/downloads/adexplorer" target="_blank" rel="noopener noreferrer">ADExplorer</a>, provenant de la suite <a href="https://learn.microsoft.com/fr-ca/sysinternals" target="_blank" rel="noopener noreferrer">SysInternals</a> de Microsoft, permet de parcourir le domaine à très bas niveau, tout comme ADSIEdit, mais ne nécessite pas l&#x27;installation des outils RSAT. Il permet une navigation plus fluide que ADSIEdit, en montrant l&#x27;arborescence LDAP dans le panneau de gauche et les attributs de l&#x27;objet sélectionné dans le panneau de droite. Cet outil n&#x27;est pas inclus dans Windows, il faut le <a href="https://learn.microsoft.com/fr-ca/sysinternals/downloads/adexplorer" target="_blank" rel="noopener noreferrer">télécharger à partir du site Web de Microsoft</a>.</p><p><img loading="lazy" alt="ADSI Edit" src="/b64-scriptage-sous-windows/assets/images/adexplorer-64a0d9b0ddd918da28b0b21ae29029cc.png" width="643" height="480" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="module-adsips">Module AdsiPS<a href="#module-adsips" class="hash-link" aria-label="Lien direct vers Module AdsiPS" title="Lien direct vers Module AdsiPS">​</a></h4><p>Le module Active Directory de Windows est très pratique mais présente deux inconvénients:</p><ul><li>Il nécessite l&#x27;installation des outils RSAT (donc des droits admin locaux et un accès à Microsoft Update)</li><li>Ses commandes n&#x27;emploient pas le protocole LDAP standard (port 389/tcp) mais plutôt ADWS (port 9389/tcp)</li></ul><p>Mon collègue François-Xavier Cat a développé un module PowerShell qui se veut une alternative au module Active Directory. Il ne nécessite pas d&#x27;installation de RSAT et passe par le protocole LDAP.</p><p>Voici le lien vers son module: <a href="https://github.com/lazywinadmin/AdsiPS" target="_blank" rel="noopener noreferrer">https://github.com/lazywinadmin/AdsiPS</a> </p><p>La manière la plus simple d&#x27;installer le module est avec la commande Install-Module</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Install-Module</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Name AdsiPS</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Si vous ne disposez pas de droits d&#x27;administration sur votre machine, vous pouvez alors le faire seulement pour votre profil utilisateur</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">Install-Module</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Name AdsiPS </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Scope CurrentUser</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Consultez cette page pour connaître la syntaxe des commandes de ce module: <a href="https://github.com/lazywinadmin/AdsiPS/blob/master/docs/doc_functions.md" target="_blank" rel="noopener noreferrer">https://github.com/lazywinadmin/AdsiPS/blob/master/docs/doc_functions.md</a> </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="extra-sid-rid-et-principaux-de-sécurité">EXTRA: SID, RID et principaux de sécurité<a href="#extra-sid-rid-et-principaux-de-sécurité" class="hash-link" aria-label="Lien direct vers EXTRA: SID, RID et principaux de sécurité" title="Lien direct vers EXTRA: SID, RID et principaux de sécurité">​</a></h2><p>Dans les services de domaine Active Directory, certains objets ont la propriété de pouvoir se faire attribuer des droits à des ressources. Ce sont ces types d&#x27;objets qui peuvent, par exemple, être ajoutés à une liste de contrôle d&#x27;accès (ACL). Ces objets se nomment les principaux de sécurité. </p><p>Active Directory compte quatre types de principaux de sécurité: les comptes utilisateurs, les comptes d&#x27;ordinateurs, les groupes, ainsi que les comptes de service gérés, plus rarement utilisés. Ces objets possèdent un numéro unique de sécurité, le SID, et c&#x27;est ce numéro qui est référencé dans les listes de permissions.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="principaux-de-sécurité-active-directory">Principaux de sécurité Active Directory<a href="#principaux-de-sécurité-active-directory" class="hash-link" aria-label="Lien direct vers Principaux de sécurité Active Directory" title="Lien direct vers Principaux de sécurité Active Directory">​</a></h3><p>Certains utilisateurs et groupes dans un domaine Active Directory sont créés automatiquement dès la création du domaine. Leur nom peut varier d&#x27;un domaine à l&#x27;autre, en fonction de la langue du premier contrôleur de domaine ayant été promu. Dans un domaine en anglais, le groupe des admins du domaine se nomme &quot;Domain Admins&quot;, alors que dans un domaine en français, il se nomme &quot;Admins du domaine&quot;. Même chose pour le compte Administrateur, qui se nomme Administrateur en français, et qu&#x27;il est même possible de renommer au moyen d&#x27;une GPO. Cela peut compliquer le développement de scripts, qu&#x27;on a avantage à rendre le plus général possible.</p><p>À titre d&#x27;exemple, voici le SID du groupe des admins du domaine sur un domaine donné. Il est composé de l&#x27;identifiant du domaine, auquel on greffe un identifiant relatif, le RID, à la fin de celui-ci. Le contrôleur de domaine qui détient le rôle FSMO de RID Master est responsable de la gestion de ces RID, afin de s&#x27;assurer qu&#x27;ils sont uniques dans tout le domaine.</p><p><img loading="lazy" alt="SID et RID" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbIAAAA/CAYAAACFKk2uAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH5woLFAIL5O+unAAAFfNJREFUeJztnX9wXNV1x7+rXwitTEoj2aAxqmRJRsWO21FwG7yqgwCB0ylgK7QjUwc7wXIa1WVWqUEaBuM6uIwdG6Tx8GOGlYg1BeIhRqGZZMoPewWufhj8YybUoipaYY1whaVV+REsGUm2Xv947+2+d9+979eudlf2+czseLT3vXvPPffcc+479761B4AEgiAIgkgxJEny2LkuQ7l4bqUhCIIgCAd4PLZiGAAgbQ7lIAiCIIg5hwIZQRAEMa+hQEYQBEGkJB6PZ4HHRo6RAhlBEASRqiwCkOfxeLLMLnIdyDobPPB4NJ+GTtd1OL51sBWVHqZ9TwOcVKOXX3BvZ4PrvpnfP4jWSlZ+nh460aApr2wdFJSL+i4oV+UyfCrBNqHTU2UrosXGPujlZ8p192quaq10PYba+426cTjGTP8N9s3rB2OHBhkYPWv1o++3QE6DnTN9sGrfqtwSkzHkzkGmnwY7Y8fAno3IVfHniF6PRvu1Ktc04GKu6+ensA1VV7z+mdgIAUAJZACutQpmkjNCUsAHCb6AFHJ4Z5Sg5AckfyAg+QDJH3QqQkDywS85vS3avF+CptGg39ifoB8S/AG5r44FtLpf1qFptUG/BDPdBP0S4JcCAZ8Eni6sygXXa7Qi+SHquyy/LxBi7vdJ6lehgE9THuLoIVY7UmUISH4wsqjy2BljB3Ykj6l6tWLD6p8h1paDkl9bN6Mfbo8CvqiMoYDkY67X9yEkBXyackP7VuVWGMdM339uBwwya2Hvt7aRyI0S4JN8zJwJsbbN2LBVuaYB2YZ8PodzPSj5bY5pgGN/bmzkSgLyq2E1AFYD+FMA+QA8kiSB/bgIZMwEdkHQrwyW48mlEGsg49anMaCgX5lgJpPLDMv7rQKZVXlQ8iuTwjBZbZXz29MGg1DAbFJzbMDCiRmcSNAf02IoFPAp7Qf5gcx4g14+pzbE3K8LOgq8YKmpwBj8dTA65ThdXpu6GiwCjWUg0onLGU+HgcpYpbn8/ECjzgV2TvD0qf3OqpyRyx+0sHmuwOaBLBSQfEp95rZhLt+VihLIfqIEMx+AUgALJE4gy3D7vNeyvRVbuzajxMW9Vc1dqAIgzCMkm6pmdMUiYKz3D3biQLcfT1QJG0Cz3ICgBatyhs5nUNftQ6BdHc1BdB7ohl8oQBW2Bnwovc0DBCU0Vw2idWMduv1BdNk0iM7ftMC3KeTKfgCgZHMXml3eCwCDnQfQ7X8CQhUzdD5Th25fALKKZP34NrVH5R9sxfYWAOjDMOC4X4Ot29ECP4KqQFVbEfCVQlZxM6oGW7Gxrhv+YJdrnTlnJUq0jZWUYCW60cfroNJ/f1CkUY7ObDDYuhF1CCBUBW5qeKVeQJSsBLr7hgEUWpSXROTeWAcERA3EQslmdMVipAQgpxZnAcwAmAIw6fF4ziuBLoKLPbIqNIcC8HXXodQirz23tOC2OOWWZSe1CVWJ8xAAgJbbBHuMw33o9i0DYtw/skvnb1oA/xPYHOn/MPq6fVgG/T6IVsSSzV2QQgEcv80Dj6cUBzaFIDWLnVjr9hbAfw/U8Dp4HFhZMmyxBxjHPjJjPNzXDVnFdvZ5OyGrSL9wU53kYGslPKV9eCIUgA/HMcjrhrJY2MQ1MsXJB7ZqAmsJNndJCAWOy3ZeegCbQhLEKlYCyT2CC6zKWUpKsBIt2K4ZEznYCqrvPIBuXwBbmeqje1SlqFsZRNdm0SRjbQQAOvFMHRBo5y2Y5aDUsl2/b7e9xW650oLcAIRiWdKNutI42bCpjRBWuH/2U1KDsJPaMbk/ljSlJEnW+0mu73WZWnR8P7Mfpcik1akoNWGVOrRMLXLTRYo82vbY/L1Wb6odCFInsgzaNhS9aOVybQs2UoucMZb3x7QyiesxpsT06a7IuAnTlWb7jZIgpabfw5N1KOqn1X6jy/1IzfyW2w4IthXsbTeY2aLRRthUJS/drtqR8lH3oph7hOW8PbVYnJGiL94YWacWLWzkCkQZt38B8GMAdwO4GUABOPtksQUyFcMmpTIomg//zIDIeTEGaBkojbll2QloPsJNZLO6xYFIdSzaScJxgbYDoc5Z8vaPBPsTsQYy/r4GL/ev1THH6QvGUtUTzwGx1/Icl7UNWAQywRgH/YK9Eu6GvNiB6r7nBiTOokDfKn9fhLPxzx9LzqLAbjkTqCwPGpjZoK0gyQ94XBsxLApsHJCy3GMy7qEZDo8wDdib55oeCvYJzQOZlY1cmSQ+kLk9ABKvJzK7G/6ctu0EyLl/ImMMnbeyF6z2YwpkFgsJYfDh3sexAZOnXV4g4X1njcnYm4yx0GlxHZlA74zjMd5v40lIcFKN2y4nUFqdvHR6MtMMs0Bvb9w4CySBjRgCiO5jZs8Why+gP2gmasPdlBfPd3Egi8cp8MuThAcyeyfjuDfGJZA5n6x2H+MTFMgMk1nwhCl8MnQXyMxW0oYynRM19suQGrJaKLBO2coJCRE5UosxNrQnfvKyFSQ5tmzHLoUn/bjH6fUOj5eO01dhXu4EYV3CI+1GDM7c1mIycrH5E5lVXTbaijW1aKZvUSCL50LjcmNuAxl3JeNsIESrLdurccXxm6YNTW8XrMR0ex2ccrurJsv72dSryb4Kt4/GtJs+NWRVLnEdr7meBCkzblpK1D7niL/dtJZRONMxtBxjTh38pwKr/UXB/SL5nLw3xNbBCQLCMbYqt6ViK9s3fxozT+/bsxH2erGORUHWfr8dBzJWx4KnVaEN2LGRKxgngcyjBDIQBEEQRKqg/MTiTgCfAhjR/ssGLfqtRYIgCGJeQ4GMIAiCmNe4/mWPVEpHOvmfRFlSqR8EQSQXt75krv1ILD7uSsBWIJOip0Ii/7IDl8iAwA6q9tejRdcAqdcPgiCSixtfkgg/IpJLW0bBLYrtJzJ1sA4dOoSXX34ZFy5cmEu5HHH11VfjgQcewLp16wxGyJLK/SAIIrnY9SWJ9iNauQAKYiyWe2SSJGF2dhazs7O4ePEiXnvttZRz/hcuXMCrr76KixcvYnZ2VrhCSvV+EASRXKx8SbL8iB0fdyVjGsi0j87qwN19993Izs5OiHB2yc7Oxtq1a3Hx4kVcunQJs7OzAPgpgFTuB0EQycXMlyTTj2RnZ+Pee+/VyUXBLIrpe2SqolTlTU9PY2pqCtPT05ieno58n2iFqo/86enpyMjIQFZWFrKysnDVVVchKysLGRkZSE9Pj1yXqv0gCCK5OPElABLmR0RyqR9VrrS0tMs2zejkPTLLPTJ1UC5duoSZmRlMTU3h66+/xtTUFGZmZiKPuuq1c406aGlpacjIyEBmZmZkdZKWlhYZXHaAU60fBEEkFze+JFF+RG1TlevSpUs6WclH6XH9Hpn250HUvxMBm6+OdfWTrH4QBJFc4ulL4u1H2J9gikedlzOO3yNTH3nVlUpaWlpcAkos7VudVLRbTyL7QRBEcomHL4mnH2GP/Kv18l4JIPRYBjI2V5uZmSn/SKPy2Jsqe2SZmZnIyMgQGmMq9oMgiOTi1Jckyo+I9shUuS7nvTE32ApkaWlyBjIzMxMAkJ6eHsnbqjnlRKPKpQ60alRqXlt0PZBa/SAIIrk48SWJ9COsXGqA1R4+oWAmYxrI1BN/6sBlZGREVgnajdFkBTLtI316enrkw1tFpWo/CIJILnZ9SaL9iJlc9ESmx9YemTZXq56aEb2rlQjY1Yg2BaAdYF56MZX6QRBEcnHjSxLhR+zIRYEsiq3UopoD1r6XlZ6eDiC5jp/3e2hmQSxV+0EQRHKx60sS7Ues/BohY/uJzOzvVMJMtvnUD4IgkovIPyTTj5DP4uPq+P3lwOXSD4Igkgf5kdQgwf+x5jjqt9Rh7dp16B/QfD3Qj/otdaiursZLBzuAni5s+PsN6OpJrHQEn46DL6G6ujq+48GOcZJtIB59nBM9mUHz5IrFla31dKG6uhovvHgAjQ1+eZ7ZuJ7bRorZnvNApnRO+6nbUo/hs1Y3TuK5/S9hZGwcu/f+GuVl6vfj2LjjZxgZG0ft+vVYXVkDABgdG3UsGuGSgX6sW7sWu3bv4xZ/PDQErzcXefmxt6GdPNExniMb4LQpIh59jIueHELzJIXg+MYn9+zFpFrOzjPm+rot9foFvglubK1jeAgAsDD/mzg3OoaiwhrL60VtdE5O2LM9B3MwFhynFlVlLF/+Z1i0KA+Tk1+ht/d9PP1UI55s3oMc4Z05qH/Ij/qH/PqvB8bxh8lJ3PydSjz4ox/J3y2uxNtvv+1UNMIt4XGcn5hAUdESTuEkwqPjyMm5BnllnGKHbURYpRnjubIBtk0h8ehjnPTkhFU0T1IJnm/sPPwWxs6Ny76RmWfs9e8dO4Z/qq/Gjp1vo3KVWUvubC0S/BZ+01YQ/HhoSNhG1R13oeqOu6wbtT0HY8NxIFOV8eP6fcpT1SQaGx7F/5z5CMMDwG9f24VTHwygtHQxQqGz2P9KO/Iwib17WvDW4U54vbnY9MMtWHvv9+QVyY6dAIB3j7wJAHisqR6NDY/ik9HPseOVR/Hk/TtRtqICjzVtQ8fBl/B8Wzs2PvgTbKhdw6+TcMy+o+8AQHSFNtCP+r1PYeDMEP7illvw0Zkh/EnxjcoiRTCWih18NjGNpSWL8dbhTixbXoHHmvfgqDJuANDe9jzy865F8Hf/jk9GP8f69euwf/+zAPg2sP+VduRp5HHbZlFhjd45CPoIjKOxYVe0baWNKVxlXKiZ6ensMPa+/JKpnq6/7lr09r6PouIy1G+tQ+CZ5zBwZghVd9wJf+PDcj0Wff9k9HPsfuVf8WzDPq4e8kzHjIgnRt84jo33PxQpZ+eZ4fqBfqx7uAnvHN2HylXb9JW7mpNaosEvDbO4iAw5QJnYaXh0HN5cLx7fUoeBM0NYtrxCmQOT+vkpaL/Dag7GEYepRc5KYGAYH52RI3dO2VmER8cRDo+gt/d9LFmyBJM4i8aGR9HdexxVd9yJgoV5OPCLF+RH6MJC+G5ZCa83Fz98sA731dwDYBLnRsewcNF1uAE34lsrbsKJY904+OoreL6tHd+9/S5sqF0jrpNwiGKwkRWaPs33+blPcX5iAnmL8iMGzNe7PG7hsU8xg0yUFReh7/QpvHGwA8srbkZZcRG83lw80tSE4sLrI2N8443lpjYw8sEprHu4CTPIxCNNTa7bLF+q7bO4j3lApG3VSZwbHVP6b6+OHIxj4yNN6O49jtr161GwMA/PPvO0sp8QlTnb+0coKy7C0JkB7Hz8Z/j2d25BWXEROg+/hVM9iDg2s74vXHQd0jAr1ANMx4yIH0bf2Hn4JEbC4cjc0c8zji8ty8M1OTkYHw1H05EA3M9JvXyqvfz5X1bihcBzyLNpp4tLlqJi+TL0nT6FDsWm1LrkhR+/ffM5GF8cPpEpnQuHsb66OvKt15uL+q3tKMQ4zo2OaSI3gJ4unDrdpzxF1UQm54mTHSivrUFuTg5ycq7BnbV/J68eB/rxh8lJlCmOY9vqW/HmkXfRFvgF8vML8A9N28zrLDPP+xIs8pgWFS9FYRnQcfANjITDkfTGg+VLUb1jp5wO6Tkl1nt4IUbC4WiZ5ml76dJCLPB6UVT8x/DdfjtyNGO8dGm5qQ2sWFGBX7/+ekTa3x/vxcjYuPxHT7/9NjU9Nu2jkuZU7U/9m027mutJL9eDf7UqutLO/5tIGvXRxm0Rme+r/QE21Nbg2pwsDLQNyY2UlYv7rpFzcc+wUA+mY0ZzJY7wfeOy5RX4adM2QPGN6jyLBoMbTLZjZFzPSe34snYNOLNTpd6hoY+BgZsideX19Avb31C7RjgH442zQKZO6uIylCwphNe7AOU3lUeF5ChLfZxub3se7W3PMxXKq5Lo6hfG/ZpV5SjIz8dIOIy/vude5FnWSTiCGTN2E1nN4xcV1mDf0V0A+HrXXmf8W57EZSsq5HHWjbGVDUTTFir5+QXIKwM6TjpoU4NZHxHu0tufKguzMW6lJ683Fzd/mxMoBPskbLpJXbWL+o6eaD1mujcbMyKOML7xvWPHcHXON/CYuqAXLJB4gYW1WbdzUgdnH3zf0Xcs7fTW1duEZUVFSyz9u2gOxhtHgazj5Amcn5jAP296jp/rFBwa8Hpzse2RJhQuvj7yXWFhIXjORj8pJ9HYsAsj4TAAyKsByzoJR5ge9DBOIpHe9+3epbtOdx/zVGMVcHQTdfcudB87iR07d6Fy1bci+1W8oGvWphna+9jgqE52OxvjwuvC4qDDBi5tumnf7qeFfdfWc+yoie5BcyURqL7x+7fdgQ21st2+eeRd9PdA9pXsAka5Pmqfk2j81SF4vbm47/uc4KHBzfiydseFsVOdPQts+NzQh+L2lcyKnTkYK472yKyOfPKUtW31rZiYOI/2A+3o6enB/uZmdLz+W7mQ42x0TuVgR+Sx9a7bv4sTx7rRP2BRJ+EIdsyWFBVhYuI8Ojr2Yu+eJ/HmkXcjjlWsdzbfz/ytTIJ3g4fR1fOeZcBRy3NyP0B4VE6ljf/fGPbuacGp0326PQe7bWox66PKoV81Yu+eJ9F97AT35JYdPT21tx4vvtiGdT/fh/z8AqyprcHHQ0PIzy9A+SqOzMzeg7jvRh2J9EBzJTF8PDQEIDqPtq2+FQDwzlH5qD1vAQMAJ9/rwe7du7Fu7f04dboP99X+QPNqkoy7OWmUj/XdVnZqVqbWZdq+yRyMNw4CmfWRT/0kVVhViZ9u/UeMj42gra0NX05MYc336uUyQ9om2sZnn3Xh3w4ewrLlFaiprYko7MTJDvM6CUewBl5TW4OK5cvQefgtfDR4FmXFRdG0n1Dvk9wDEtH7KlCxfBmGzgzgw/7/5gYcng0UrliBPX97HzyQ8Oz+/fhi4msU5OdHrrPb5tDw/+r6bNbHmto1kY3tjwbP4vqF+fq0p406tHr65S8PIm9hAXb/XD7dpU+jMjIrQV0+dJJn2ndVR94VV1nogeZKItAf5EBkS+TDD/4L4+A/eQPA6dO/x5EjR5C3sAA7du6S95kY3M1JLQLfbWGnRcVlyMRMpOzxndGySF1m7ZvMwXjjASDRD+YSBEEQ1sivFFy76AaL94ZjR/n5r50APgUwov2XDVqO3yMjCIIgrjze6+nC7974D+6BlGST4N9aJAiCIOYj/3n0HfT2vq95pSB1oNQiQRAEkXI4SS3SExlBEAQxr6FARhAEQcxrKJARBEEQ85oMgP6XU4IgCGL+kiFJki6KeTyeBQAWcT4EQRAEkUhGAYQBfAbgCwBf8U4n8t4jOw8gG0AmgHTlu9k5EpIgCIIgRIQBjEMOZF9Cjk8GDIFMkiTJ4/F8iej+2SUAM3MkJEEQBEGI+Ezz+VL0rhj3lz0kSZr2eDyfQ34SmwEwNVdSEgRBEISALyA/iX0pSdK06CKP2cvQHvkUSC6ABXEXjyAIgiDM+QrAeatf7TANZJGL6FgjQRAEkWDs/uyUrUBGEARBEKkKvRBNEARBzGsokBEEQRDzGgpkBEEQxLzm/wExze3g4lG+QwAAAABJRU5ErkJggg==" width="434" height="63" class="img_ev3q"></p><p>Les principaux de domaine, quant à eux, sont relatifs au domaine, mais leur RID est toujours le même d&#x27;un domaine à l&#x27;autre. Le groupe des admins du domaine possède le RID 512, donc leur SID est équivalent au SID du domaine, suivi de &quot;-512&quot;. On peut donc obtenir le SID de tout principal de domaine simplement en connaissant son RID ainsi que le SID du domaine, qui peut être obtenu par la commande Get-ADDomain. Les identifiants sont documentés sur le site de Microsoft.</p><p>En voici quelques exemples:</p><table><thead><tr><th>Nom</th><th>Type</th><th>RID (décimal)</th><th>RID (hexadécimal)</th></tr></thead><tbody><tr><td>Administrateur</td><td>Utilisateur</td><td>500</td><td>0x000001F4</td></tr><tr><td>Admins du domaine</td><td>Groupe global</td><td>512</td><td>0x00000200</td></tr><tr><td>Utilisateurs du domaine</td><td>Groupe global</td><td>513</td><td>0x00000201</td></tr><tr><td>Ordinateurs du domaine</td><td>Groupe global</td><td>515</td><td>0x00000203</td></tr><tr><td>Contrôleurs de domaine</td><td>Groupe global</td><td>516</td><td>0x00000204</td></tr><tr><td>Administrateurs du schéma</td><td>Groupe universel</td><td>518</td><td>0x00000206</td></tr><tr><td>Administrateurs de l&#x27;entreprise</td><td>Groupe universel</td><td>519</td><td>0x00000207</td></tr></tbody></table><p>Il est préférable d&#x27;utiliser le SID d&#x27;un de ces principaux, plutôt que son nom, car ainsi, le script peut fonctionner indépendamment de la langue. Il suffit de réunir le SID du domaine et le RID du principal pour obtenir son SID.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token variable" style="color:rgb(9, 134, 88)">$DOMAIN_GROUP_RID_ADMINS</span><span class="token plain"> = 512</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$DomainSID</span><span class="token plain"> = </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">Get-ADDomain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">DomainSid</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">Value</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$DomainAdminSID</span><span class="token plain"> = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token string variable" style="color:rgb(9, 134, 88)">$DomainSID</span><span class="token string" style="color:rgb(163, 21, 21)">-</span><span class="token string variable" style="color:rgb(9, 134, 88)">$DOMAIN_GROUP_RID_ADMINS</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Get-ADGroup</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Identity </span><span class="token variable" style="color:rgb(9, 134, 88)">$DomainAdminSID</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="groupes-de-sécurité-locaux">Groupes de sécurité locaux<a href="#groupes-de-sécurité-locaux" class="hash-link" aria-label="Lien direct vers Groupes de sécurité locaux" title="Lien direct vers Groupes de sécurité locaux">​</a></h3><p>Windows dispose de groupes créés automatiquement dès son installation, ainsi que des principaux spéciaux, comme les &quot;utilisateurs authentifiés&quot; ou le groupe &quot;tout le monde&quot;. Ces principaux ont toujours le même SID peu importe la machine et peu importe la langue. Les principaux locaux possèdent toujours le même SID. </p><table><thead><tr><th>Nom</th><th>SID</th></tr></thead><tbody><tr><td>Administrateurs</td><td>S-1-5-32-544</td></tr><tr><td>Utilisateurs</td><td>S-1-5-32-545</td></tr><tr><td>Utilisateurs du bureau à distance</td><td>S-1-5-32-555</td></tr><tr><td>Invités</td><td>S-1-5-32-546</td></tr><tr><td>Utilisateurs authentifiés</td><td>S-1-5-11</td></tr><tr><td>SYSTÈME</td><td>S-1-5-18</td></tr><tr><td>Tout le monde</td><td>S-1-1-0</td></tr></tbody></table><p>Référence: <a href="https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/security-identifiers" target="_blank" rel="noopener noreferrer">Security identifiers (Windows 10) - Windows security | Microsoft Docs</a></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Pages de documentation"><a class="pagination-nav__link pagination-nav__link--prev" href="/b64-scriptage-sous-windows/cours/04"><div class="pagination-nav__sublabel">Précédent</div><div class="pagination-nav__label">R04 - Paramètres, fonctions, fichiers et strings</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#gestion-des-comptes-locaux" class="table-of-contents__link toc-highlight">Gestion des comptes locaux</a><ul><li><a href="#consulter-les-utilisateurs-existants" class="table-of-contents__link toc-highlight">Consulter les utilisateurs existants</a></li><li><a href="#création-dun-nouvel-utilisateur" class="table-of-contents__link toc-highlight">Création d&#39;un nouvel utilisateur</a></li><li><a href="#groupes-locaux" class="table-of-contents__link toc-highlight">Groupes locaux</a></li></ul></li><li><a href="#gestion-des-comptes-du-domaine" class="table-of-contents__link toc-highlight">Gestion des comptes du domaine</a><ul><li><a href="#outils-rsat" class="table-of-contents__link toc-highlight">Outils RSAT</a></li><li><a href="#informations-sur-le-domaine-et-la-forêt" class="table-of-contents__link toc-highlight">Informations sur le domaine et la forêt</a></li><li><a href="#unités-dorganisation" class="table-of-contents__link toc-highlight">Unités d&#39;organisation</a></li><li><a href="#comptes-utilisateurs" class="table-of-contents__link toc-highlight">Comptes utilisateurs</a></li><li><a href="#groupes" class="table-of-contents__link toc-highlight">Groupes</a></li><li><a href="#membres-de-groupes" class="table-of-contents__link toc-highlight">Membres de groupes</a></li><li><a href="#attributs" class="table-of-contents__link toc-highlight">Attributs</a></li><li><a href="#outils-supplémentaires" class="table-of-contents__link toc-highlight">Outils supplémentaires</a></li></ul></li><li><a href="#extra-sid-rid-et-principaux-de-sécurité" class="table-of-contents__link toc-highlight">EXTRA: SID, RID et principaux de sécurité</a><ul><li><a href="#principaux-de-sécurité-active-directory" class="table-of-contents__link toc-highlight">Principaux de sécurité Active Directory</a></li><li><a href="#groupes-de-sécurité-locaux" class="table-of-contents__link toc-highlight">Groupes de sécurité locaux</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Sources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/departement-info-cem/b64-scriptage-sous-windows" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Vincent Carrier. Tous droits réservés.</div></div></div></footer></div>
<script src="/b64-scriptage-sous-windows/assets/js/runtime~main.93079054.js"></script>
<script src="/b64-scriptage-sous-windows/assets/js/main.7ce15393.js"></script>
</body>
</html>