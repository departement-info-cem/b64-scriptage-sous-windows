"use strict";(self.webpackChunkdepinfo_template=self.webpackChunkdepinfo_template||[]).push([[857],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>k});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var o=r.createContext({}),p=function(e){var t=r.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(o.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=p(n),c=a,k=d["".concat(o,".").concat(c)]||d[c]||m[c]||i;return n?r.createElement(k,l(l({ref:t},u),{},{components:n})):r.createElement(k,l({ref:t},u))}));function k(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,l=new Array(i);l[0]=c;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s[d]="string"==typeof e?e:a,l[1]=s;for(var p=2;p<i;p++)l[p]=n[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},73646:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>m,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var r=n(87462),a=(n(67294),n(3905));const i={title:"Travail pratique 2",slug:"tp2",draft:!1},l="Travail pratique 2 (A2023)",s={unversionedId:"tp/tp2",id:"tp/tp2",title:"Travail pratique 2",description:"Ce TP est \xe0 faire individuellement. Il compte pour 30% de la note du cours. La remise doit obligatoirement se faire par GitHub Classroom.",source:"@site/docs/tp/tp2.md",sourceDirName:"tp",slug:"/tp/tp2",permalink:"/b64-scriptage-sous-windows/tp/tp2",draft:!1,tags:[],version:"current",lastUpdatedAt:1699997925,formattedLastUpdatedAt:"14 nov. 2023",frontMatter:{title:"Travail pratique 2",slug:"tp2",draft:!1},sidebar:"tp",previous:{title:"Travail pratique 1",permalink:"/b64-scriptage-sous-windows/tp/tp1"}},o={},p=[{value:"Mandat",id:"mandat",level:2},{value:"Pr\xe9paration",id:"pr\xe9paration",level:2},{value:"Partie 1: Script de lancement",id:"partie-1-script-de-lancement",level:2},{value:"Fonctionnement du script",id:"fonctionnement-du-script",level:3},{value:"Conseils",id:"conseils",level:3},{value:"Partie 2: Script de d\xe9ploiement",id:"partie-2-script-de-d\xe9ploiement",level:2},{value:"Fonctionnement du script",id:"fonctionnement-du-script-1",level:3},{value:"Conseils",id:"conseils-1",level:3},{value:"Exigences d&#39;\xe9valuation",id:"exigences-d\xe9valuation",level:2}],u={toc:p},d="wrapper";function m(e){let{components:t,...i}=e;return(0,a.kt)(d,(0,r.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"travail-pratique-2-a2023"},"Travail pratique 2 (A2023)"),(0,a.kt)("p",null,"Ce TP est \xe0 faire individuellement. Il compte pour ",(0,a.kt)("strong",{parentName:"p"},"30%")," de la note du cours. La remise doit obligatoirement se faire par GitHub Classroom."),(0,a.kt)("h2",{id:"mandat"},"Mandat"),(0,a.kt)("p",null,"Vous devez implanter l\u2019outil ",(0,a.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/fr-ca/sysinternals/downloads/bginfo"},"BGInfo")," (faisant partie de la suite ",(0,a.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/fr-ca/sysinternals/"},"Sysinternals")," de Microsoft) dans votre environnement de serveurs et de postes de travail Windows. Cet outil sert \xe0 modifier le fond d\u2019\xe9cran pour y ajouter de l\u2019information utile comme le nom de la machine, le domaine, le nom d\u2019utilisateur, la configuration IP, etc."),(0,a.kt)("p",null,"L'outil BGInfo doit \xeatre lanc\xe9 automatiquement ",(0,a.kt)("strong",{parentName:"p"},"\xe0 chaque ouverture d'une session utilisateur"),", afin de rafra\xeechir le fond d'\xe9cran avec l'information la plus r\xe9cente. C'est pourquoi dans ce TP, il vous faudra r\xe9aliser deux scripts:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Un ",(0,a.kt)("strong",{parentName:"li"},"script de lancement")," de BGInfo, qui devra \xeatre d\xe9marr\xe9 automatiquement au d\xe9marrage d'une session, au moyen d'une t\xe2che planifi\xe9e, et qui lancera l'outil BGInfo en lui chargeant le mod\xe8le appropri\xe9 au type de machine et \xe0 l'utilisateur."),(0,a.kt)("li",{parentName:"ul"},"Un ",(0,a.kt)("strong",{parentName:"li"},"script de d\xe9ploiement"),", qui devra cr\xe9er une t\xe2che planifi\xe9e sur une ou plusieurs machines de votre r\xe9seau (\xe0 l'aide de sessions PSRemoting);")),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(31197).Z,width:"900",height:"400"})),(0,a.kt)("h2",{id:"pr\xe9paration"},"Pr\xe9paration"),(0,a.kt)("p",null,"Voici les \xe9tapes \xe0 suivre pour vous pr\xe9parer \xe0 faire ce TP:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Assurez-vous d'avoir correctement pr\xe9par\xe9 ",(0,a.kt)("strong",{parentName:"p"},"toutes les machines de votre domaine")," pour pouvoir ex\xe9cuter des scripts (",(0,a.kt)("inlineCode",{parentName:"p"},"Set-ExecutionPolicy RemoteSigned"),") et pour accepter des sessions distantes (",(0,a.kt)("inlineCode",{parentName:"p"},"Enable-PSRemoting -Force"),").")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Assurez-vous de d\xe9marrer une session avec un compte ",(0,a.kt)("strong",{parentName:"p"},"administrateur du domaine")," sur votre machine de d\xe9veloppement (celle sur laquelle vous avez install\xe9 VS Code). Elle doit \xeatre membre de votre domaine. Cela peut \xeatre un poste de travail Windows 10 ou le contr\xf4leur de domaine, peu importe.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Cliquez sur le lien GitHub Classroom qui vous a \xe9t\xe9 communiqu\xe9 par votre professeur et clonez le d\xe9p\xf4t sur votre machine de d\xe9veloppement. Vous devriez avoir ces fichiers dans le r\xe9pertoire racine de votre d\xe9p\xf4t:"),(0,a.kt)("p",{parentName:"li"},(0,a.kt)("img",{src:n(84344).Z,width:"220",height:"270"}))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Ouvrez la racine de ce r\xe9pertoire dans Visual Studio Code."))),(0,a.kt)("h2",{id:"partie-1-script-de-lancement"},"Partie 1: Script de lancement"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Nom du script: ",(0,a.kt)("inlineCode",{parentName:"strong"},"bginfo.ps1"))),(0,a.kt)("p",null,"L\u2019outil ",(0,a.kt)("strong",{parentName:"p"},"Bginfo64.exe")," ainsi que trois fichiers BGI vous sont fournis pour ce TP via le lien GitHub. Les fichiers BGI d\xe9crivent comment l\u2019outil doit se comporter, soit l\u2019information \xe0 afficher, la couleur du fond d\u2019\xe9cran, etc."),(0,a.kt)("p",null,"Pour appliquer un fichier BGI, vous devez le sp\xe9cifier en param\xe8tre \xe0 l\u2019outil par ligne de commande. Voici la commande \xe0 utiliser, qui doit \xeatre lanc\xe9e dans le contexte de l\u2019utilisateur, ",(0,a.kt)("strong",{parentName:"p"},"\xe0 chaque fois qu'un utilisateur d\xe9marre une session")," :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'"C:\\chemin\\vers\\Bginfo64.exe" "C:\\chemin\\vers\\fichier.bgi" /timer:0 /nolicprompt\n')),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"Dans l'exemple ci-dessus, la commande est montr\xe9e telle qu'elle devrait \xeatre \xe9crite dans une ",(0,a.kt)("strong",{parentName:"p"},"invite de commande classique")," (cmd.exe). Dans un script PowerShell toutefois, l'appel de commandes externes devrait se faire \xe0 l'aide de ",(0,a.kt)("inlineCode",{parentName:"p"},"Start-Process"),". Il est important de bien porter attention \xe0 la structure de la commande."),(0,a.kt)("p",{parentName:"admonition"},"Dans la commande ci-dessus, le chemin menant \xe0 l'ex\xe9cutable repr\xe9sente le programme. On le passe dans le param\xe8tre ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("inlineCode",{parentName:"strong"},"FilePath")),". Les autres \xe9l\xe9ments (apr\xe8s le premier espace) sont des ",(0,a.kt)("strong",{parentName:"p"},"arguments"),". Il peut y en avoir plusieurs: ",(0,a.kt)("inlineCode",{parentName:"p"},'"C:\\chemin\\vers\\fichier.bgi"')," est un argument, ",(0,a.kt)("inlineCode",{parentName:"p"},"/timer:0")," en est un autre et ",(0,a.kt)("inlineCode",{parentName:"p"},"/nolicprompt")," en est un troisi\xe8me. Il faut passer tous les arguments dans le param\xe8tre ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("inlineCode",{parentName:"strong"},"ArgumentList")),", s\xe9par\xe9s par des virgules."),(0,a.kt)("p",{parentName:"admonition"},"Par exemple, pour lancer la commande ",(0,a.kt)("inlineCode",{parentName:"p"},'"C:\\Windows\\System32\\ping.exe" /t 127.0.0.1')," \xe0 l'aide de la commande ",(0,a.kt)("inlineCode",{parentName:"p"},"Start-Process"),", la syntaxe serait:"),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-powershell"},'Start-Process -FilePath "C:\\Windows\\System32\\ping.exe" -ArgumentList "/t", "127.0.0.1"\n'))),(0,a.kt)("p",null,"La premi\xe8re partie du TP consistera \xe0 d\xe9velopper un script qui lance la commande de l\u2019outil BGinfo en lui fournissant un fichier BGI en fonction de deux crit\xe8res :"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Si l\u2019utilisateur courant est membre du groupe local des administrateurs (SID: ",(0,a.kt)("inlineCode",{parentName:"li"},"S-1-5-32-544"),"), directement ou par ",(0,a.kt)("em",{parentName:"li"},"nesting"),"."),(0,a.kt)("li",{parentName:"ul"},"Si la machine est un client ou un serveur. (Vous devez le v\xe9rifier par une requ\xeate WMI).")),(0,a.kt)("p",null,"*",(0,a.kt)("em",{parentName:"p"},"Consultez la section Conseils plus bas pour savoir comment effectuer ces v\xe9rifications.")),(0,a.kt)("h3",{id:"fonctionnement-du-script"},"Fonctionnement du script"),(0,a.kt)("p",null,"L'algorithme principal de votre script devrait donc \xeatre semblable \xe0 celui-ci:"),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(91097).Z,width:"1030",height:"350"})),(0,a.kt)("p",null,"En fonction des v\xe9rifications men\xe9es par le script, celui-ci devra choisir un des trois fichiers BGI \xe0 passer en argument \xe0 Bginfo.exe. Voici l'effet des trois fichiers et la condition de leur application."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Fichier"),(0,a.kt)("th",{parentName:"tr",align:null},"Admin?"),(0,a.kt)("th",{parentName:"tr",align:null},"Type de machine"),(0,a.kt)("th",{parentName:"tr",align:null},"Effet"),(0,a.kt)("th",{parentName:"tr",align:null},"Aper\xe7u"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"admin.bgi")),(0,a.kt)("td",{parentName:"tr",align:null},"Oui"),(0,a.kt)("td",{parentName:"tr",align:null},"Peu importe"),(0,a.kt)("td",{parentName:"tr",align:null},"Le texte s'affiche sur ",(0,a.kt)("strong",{parentName:"td"},"fond rouge")," et est ",(0,a.kt)("strong",{parentName:"td"},"d\xe9taill\xe9"),"."),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("img",{src:n(40221).Z,width:"331",height:"102"}))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"client.bgi")),(0,a.kt)("td",{parentName:"tr",align:null},"Non"),(0,a.kt)("td",{parentName:"tr",align:null},"Poste de travail (Windows 10)"),(0,a.kt)("td",{parentName:"tr",align:null},"Le texte s\u2019affiche sur le ",(0,a.kt)("strong",{parentName:"td"},"fond d\u2019\xe9cran existant")," et est ",(0,a.kt)("strong",{parentName:"td"},"sommaire"),"."),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("img",{src:n(89939).Z,width:"331",height:"102"}))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"server.bgi")),(0,a.kt)("td",{parentName:"tr",align:null},"Non"),(0,a.kt)("td",{parentName:"tr",align:null},"Serveur ou contr\xf4leur de domaine (Windows Server)"),(0,a.kt)("td",{parentName:"tr",align:null},"Le texte s\u2019affiche sur le ",(0,a.kt)("strong",{parentName:"td"},"fond d\u2019\xe9cran existant")," et est ",(0,a.kt)("strong",{parentName:"td"},"d\xe9taill\xe9"),"."),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("img",{src:n(78093).Z,width:"331",height:"102"}))))),(0,a.kt)("p",null,"Ce script PowerShell devra se trouver au m\xeame endroit que ",(0,a.kt)("inlineCode",{parentName:"p"},"bginfo64.exe")," ainsi que les fichiers BGI. Il n\u2019a pas \xe0 admettre de param\xe8tres. Il doit simplement v\xe9rifier si l\u2019ordinateur est un serveur ou un client, si l\u2019utilisateur est admin ou non, et lancer la commande avec le bon fichier BGI. Vous devez utiliser la variable ",(0,a.kt)("inlineCode",{parentName:"p"},"$PSScriptRoot")," pour vous r\xe9f\xe9rer \xe0 l\u2019emplacement de votre fichier PS1."),(0,a.kt)("h3",{id:"conseils"},"Conseils"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Voici comment v\xe9rifier si un utilisateur dispose de droits d'administration ou non. Cette m\xe9thode tient compte du ",(0,a.kt)("em",{parentName:"p"},"nesting")," de groupes."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-powershell"},'(whoami /groups /fo csv | ConvertFrom-Csv).sid -contains "S-1-5-32-544"\n'))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Pour diff\xe9rencier les serveurs des postes de travail (clients), int\xe9ressez-vous \xe0 la classe WMI ",(0,a.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/fr-ca/windows/win32/cimwin32prov/win32-operatingsystem"},(0,a.kt)("inlineCode",{parentName:"a"},"Win32_OperatingSystem")))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Utilisez la commande ",(0,a.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/fr-ca/powershell/module/microsoft.powershell.management/start-process?view=powershell-5.1"},(0,a.kt)("inlineCode",{parentName:"a"},"Start-Process"))," pour lancer votre commande ainsi que ses arguments.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Utilisez la variable ",(0,a.kt)("inlineCode",{parentName:"p"},"$PSScriptRoot")," pour r\xe9cup\xe9rer le chemin o\xf9 se trouve votre fichier. Par exemple, si le script doit faire r\xe9f\xe9rence au fichier ",(0,a.kt)("inlineCode",{parentName:"p"},"Bginfo64.exe")," situ\xe9 dans le m\xeame r\xe9pertoire que lui, alors son chemin pourrait \xeatre ",(0,a.kt)("inlineCode",{parentName:"p"},"$PSScriptRoot\\Bginfo64.exe"),"."))),(0,a.kt)("h2",{id:"partie-2-script-de-d\xe9ploiement"},"Partie 2: Script de d\xe9ploiement"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Nom du script: ",(0,a.kt)("inlineCode",{parentName:"strong"},"deploy.ps1"))),(0,a.kt)("p",null,"L\u2019outil BGInfo sert \xe0 afficher de l\u2019information sur le papier peint de Windows. Une fois l\u2019outil lanc\xe9, ce texte ne sera pas mis \xe0 jour avant que l\u2019outil soit lanc\xe9 de nouveau. Il est donc recommand\xe9 de planifier son lancement au d\xe9marrage d\u2019une session utilisateur."),(0,a.kt)("p",null,"Votre mandat consiste \xe0 d\xe9velopper un script PowerShell pour d\xe9ployer votre solution d'application de Bginfo, \xe0 distance sur une ou plusieurs machines du domaine. Ainsi, apr\xe8s que la solution soit d\xe9ploy\xe9e sur une machine, tout utilisateur qui d\xe9marre une session sur cette machine verra son fond d'\xe9cran modifi\xe9 par l'outil Bginfo automatiquement."),(0,a.kt)("p",null,"Le script devrait s\u2019utiliser ainsi :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-powershell"},'.\\deploy.ps1 -Ordinateurs "Serveur1"\n')),(0,a.kt)("p",null,"Il doit pouvoir \xe9galement admettre plusieurs ordinateurs dans son param\xe8tre ",(0,a.kt)("inlineCode",{parentName:"p"},"Ordinateurs"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-powershell"},'.\\deploy.ps1 -Ordinateurs "Serveur1","Serveur2","Serveur3"\n')),(0,a.kt)("h3",{id:"fonctionnement-du-script-1"},"Fonctionnement du script"),(0,a.kt)("p",null,"Votre script doit effectuer les t\xe2ches suivantes, ",(0,a.kt)("strong",{parentName:"p"},"pour chaque ordinateur sp\xe9cifi\xe9 en param\xe8tre")," ",(0,a.kt)("em",{parentName:"p"},"(\xe7a prend une boucle!)")," :"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\xc9tablir une session PowerShell \xe0 distance \xe0 l'aide de la commande ",(0,a.kt)("inlineCode",{parentName:"p"},"New-PSSession"),".")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Cr\xe9er un r\xe9pertoire ",(0,a.kt)("inlineCode",{parentName:"p"},"C:\\Scripts\\")," sur l'ordinateur distant \xe0 travers la session (s'il n'existe pas d\xe9j\xe0, bien s\xfbr).")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Copier tous les fichiers de votre solution Bginfo dans le r\xe9pertoire ",(0,a.kt)("inlineCode",{parentName:"p"},"C:\\Scripts\\Bginfo\\")," de l\u2019ordinateur cible (soit le fichier ",(0,a.kt)("inlineCode",{parentName:"p"},"bginfo.exe"),", tous les fichiers BGI, et votre script ",(0,a.kt)("inlineCode",{parentName:"p"},"bginfo.ps1")," que vous avez d\xe9velopp\xe9 pr\xe9alablement). Utilisez la variable ",(0,a.kt)("inlineCode",{parentName:"p"},"$PSScriptRoot")," pour r\xe9f\xe9rer au r\xe9pertoire dans lequel le script est situ\xe9.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Cr\xe9er une t\xe2che planifi\xe9e sur l'ordinateur distant selon ces crit\xe8res:"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"D\xe9clencheur (",(0,a.kt)("em",{parentName:"strong"},"trigger"),"):")," La t\xe2che doit \xeatre lanc\xe9e automatiquement au d\xe9marrage d'une session utilisateur"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Action:")," Le lancement du script ",(0,a.kt)("inlineCode",{parentName:"li"},"bginfo.ps1")," doit se faire au moyen de l'interpr\xe9teur ",(0,a.kt)("inlineCode",{parentName:"li"},"PowerShell.exe")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Principal:")," Le script doit \xeatre ex\xe9cut\xe9 avec les privil\xe8ges du groupe des utilisateurs (SID: ",(0,a.kt)("inlineCode",{parentName:"li"},"S-1-5-32-545"),")")))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Vous devez obligatoirement utiliser des sessions PowerShell (",(0,a.kt)("inlineCode",{parentName:"strong"},"PSSession"),") pour r\xe9aliser ce TP. N'utilisez pas ",(0,a.kt)("inlineCode",{parentName:"strong"},"Enter-PSSession")," dans un script!")),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(3723).Z,width:"960",height:"770"})),(0,a.kt)("h3",{id:"conseils-1"},"Conseils"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Utilisez la commande ",(0,a.kt)("inlineCode",{parentName:"p"},"Copy-Item")," en sp\xe9cifiant la session PSRemoting pour transf\xe9rer les fichiers vers la machine distante")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Stockez les fichiers dans un r\xe9pertoire \xe0 la racine du script. Ainsi, vous pourrez utiliser un chemin relatif \xe0 ",(0,a.kt)("inlineCode",{parentName:"p"},"$PSScriptRoot")," plut\xf4t qu'un chemin absolu."))),(0,a.kt)("h2",{id:"exigences-d\xe9valuation"},"Exigences d'\xe9valuation"),(0,a.kt)("p",null,"L\u2019\xe9valuation de votre travail prendra en compte les crit\xe8res suivants:"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Crit\xe8re d'\xe9valuation"),(0,a.kt)("th",{parentName:"tr",align:"right"},"Pond\xe9ration"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Partie 1: Fonctionnement du script ",(0,a.kt)("inlineCode",{parentName:"td"},"bginfo.ps1")),(0,a.kt)("td",{parentName:"tr",align:"right"},"30%")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Partie 2: Fonctionnement du script ",(0,a.kt)("inlineCode",{parentName:"td"},"deploy.ps1")),(0,a.kt)("td",{parentName:"tr",align:"right"},"40%")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Logique et conception"),(0,a.kt)("td",{parentName:"tr",align:"right"},"15%")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Style et lisibilit\xe9"),(0,a.kt)("td",{parentName:"tr",align:"right"},"10%")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Respect des consignes de remise"),(0,a.kt)("td",{parentName:"tr",align:"right"},"5%")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"Total")),(0,a.kt)("td",{parentName:"tr",align:"right"},(0,a.kt)("strong",{parentName:"td"},"100%"))))),(0,a.kt)("p",null,"Voici les d\xe9tails de ce qui sera \xe9valu\xe9 pour chaque crit\xe8re:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Partie 1: Fonctionnement du script ",(0,a.kt)("inlineCode",{parentName:"strong"},"bginfo.ps1"))," (30%)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Toutes les fonctionnalit\xe9s demand\xe9es doivent \xeatre impl\xe9ment\xe9es et fonctionnelles"),(0,a.kt)("li",{parentName:"ul"},"Aucun objet ne doit sortir sur le pipeline"),(0,a.kt)("li",{parentName:"ul"},"Utilisation ad\xe9quate de WMI"),(0,a.kt)("li",{parentName:"ul"},"Il ne doit pas y avoir de message d'erreur visible lors de l'ex\xe9cution du script"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Partie 2: Fonctionnement du script ",(0,a.kt)("inlineCode",{parentName:"strong"},"deploy.ps1"))," (40%)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Toutes les fonctionnalit\xe9s demand\xe9es doivent \xeatre impl\xe9ment\xe9es et fonctionnelles"),(0,a.kt)("li",{parentName:"ul"},"D\xe9finition ad\xe9quate du param\xe8tre"),(0,a.kt)("li",{parentName:"ul"},"Prise en charge de plusieurs machines \xe0 la fois"),(0,a.kt)("li",{parentName:"ul"},"Gestion de la session PSRemoting et utilisation de cette session pour toutes les op\xe9rations sur la machine distante"),(0,a.kt)("li",{parentName:"ul"},"Cr\xe9ation du r\xe9pertoire distant si n\xe9cessaire"),(0,a.kt)("li",{parentName:"ul"},"Copie de fichiers \xe0 travers la session"),(0,a.kt)("li",{parentName:"ul"},"Cr\xe9ation de la t\xe2che planifi\xe9e"),(0,a.kt)("li",{parentName:"ul"},"Aucun objet ne doit sortir sur le pipeline"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Logique et conception")," (15%)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Votre code doit \xeatre logique et \xe9viter des tournures redondantes ou inutiles"),(0,a.kt)("li",{parentName:"ul"},"\xc9viter les chemins absolus et ",(0,a.kt)("em",{parentName:"li"},"hard-cod\xe9s")," (particuli\xe8rement ceux vers un profil utilisateur)"),(0,a.kt)("li",{parentName:"ul"},"Le nom des commandes, des param\xe8tres ainsi que la structure des objets doivent \xeatre conformes aux sp\xe9cifications de l\u2019\xe9nonc\xe9"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Style et lisibilit\xe9")," (10%)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Les noms des variables et des fonctions doit \xeatre repr\xe9sentatif"),(0,a.kt)("li",{parentName:"ul"},"Les commentaires doivent \xeatre pertinents"),(0,a.kt)("li",{parentName:"ul"},"Le code doit \xeatre correctement indent\xe9"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Respect des consignes de remise")," (5%)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"La remise a \xe9t\xe9 faite sur GitHub tel que demand\xe9"),(0,a.kt)("li",{parentName:"ul"},"Toutes les consignes sont respect\xe9es")))))}m.isMDXComponent=!0},40221:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/bgi_admin-446bc78821e266f39009054778fd0af1.png"},89939:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/bgi_client-af04e86e8770b60e7058cd116bc35e03.png"},78093:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/bgi_server-606b131dc2cfe73ec216844eefa111b6.png"},84344:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/tp2-depot-073e063f6bf49ffcbe92e86ce57aab83.svg"},31197:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/tp2-fichiers-3a3cd5aaad58db2235991bf7162fc473.svg"},91097:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/tp2-partie1-080eb5e088a54c11e0037fecb692c7ab.svg"},3723:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/tp2-partie2-43ad5dd30920f107136eaa1ef6066723.svg"}}]);