"use strict";(self.webpackChunkdepinfo_template=self.webpackChunkdepinfo_template||[]).push([[561],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>k});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=a.createContext({}),u=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(o.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,o=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=u(n),m=r,k=d["".concat(o,".").concat(m)]||d[m]||c[m]||s;return n?a.createElement(k,i(i({ref:t},p),{},{components:n})):a.createElement(k,i({ref:t},p))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,i=new Array(s);i[0]=m;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l[d]="string"==typeof e?e:r,i[1]=l;for(var u=2;u<s;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},85162:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(67294),r=n(86010);const s={tabItem:"tabItem_Ymn6"};function i(e){let{children:t,hidden:n,className:i}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(s.tabItem,i),hidden:n},t)}},74866:(e,t,n)=>{n.d(t,{Z:()=>w});var a=n(87462),r=n(67294),s=n(86010),i=n(12466),l=n(16550),o=n(91980),u=n(67392),p=n(50012);function d(e){return function(e){return r.Children.map(e,(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}function c(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??d(n);return function(e){const t=(0,u.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function m(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function k(e){let{queryString:t=!1,groupId:n}=e;const a=(0,l.k6)(),s=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,o._X)(s),(0,r.useCallback)((e=>{if(!s)return;const t=new URLSearchParams(a.location.search);t.set(s,e),a.replace({...a.location,search:t.toString()})}),[s,a])]}function g(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,s=c(e),[i,l]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:s}))),[o,u]=k({queryString:n,groupId:a}),[d,g]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,s]=(0,p.Nk)(n);return[a,(0,r.useCallback)((e=>{n&&s.set(e)}),[n,s])]}({groupId:a}),b=(()=>{const e=o??d;return m({value:e,tabValues:s})?e:null})();(0,r.useLayoutEffect)((()=>{b&&l(b)}),[b]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),g(e)}),[u,g,s]),tabValues:s}}var b=n(72389);const h={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function f(e){let{className:t,block:n,selectedValue:l,selectValue:o,tabValues:u}=e;const p=[],{blockElementScrollPositionUntilNextRender:d}=(0,i.o5)(),c=e=>{const t=e.currentTarget,n=p.indexOf(t),a=u[n].value;a!==l&&(d(t),o(a))},m=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const n=p.indexOf(e.currentTarget)+1;t=p[n]??p[0];break}case"ArrowLeft":{const n=p.indexOf(e.currentTarget)-1;t=p[n]??p[p.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":n},t)},u.map((e=>{let{value:t,label:n,attributes:i}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:l===t?0:-1,"aria-selected":l===t,key:t,ref:e=>p.push(e),onKeyDown:m,onClick:c},i,{className:(0,s.Z)("tabs__item",h.tabItem,i?.className,{"tabs__item--active":l===t})}),n??t)})))}function v(e){let{lazy:t,children:n,selectedValue:a}=e;const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=s.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},s.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function N(e){const t=g(e);return r.createElement("div",{className:(0,s.Z)("tabs-container",h.tabList)},r.createElement(f,(0,a.Z)({},e,t)),r.createElement(v,(0,a.Z)({},e,t)))}function w(e){const t=(0,b.Z)();return r.createElement(N,(0,a.Z)({key:String(t)},e))}},85706:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>k,frontMatter:()=>l,metadata:()=>u,toc:()=>d});var a=n(87462),r=(n(67294),n(3905)),s=n(74866),i=n(85162);const l={title:"R09 - Requ\xeates WMI",slug:"09",draft:!1},o="Rencontre 9 - Requ\xeates WMI",u={unversionedId:"cours/r09",id:"cours/r09",title:"R09 - Requ\xeates WMI",description:"1. Pr\xe9sentation de WMI",source:"@site/docs/cours/r09.md",sourceDirName:"cours",slug:"/cours/09",permalink:"/b64-scriptage-sous-windows/cours/09",draft:!1,tags:[],version:"current",lastUpdatedAt:1699997700,formattedLastUpdatedAt:"14 nov. 2023",frontMatter:{title:"R09 - Requ\xeates WMI",slug:"09",draft:!1},sidebar:"docs",previous:{title:"R08 - Registre et streams",permalink:"/b64-scriptage-sous-windows/cours/08"},next:{title:"R10 - WinRM et planification",permalink:"/b64-scriptage-sous-windows/cours/10"}},p={},d=[{value:"\xc0 quoi sert WMI?",id:"\xe0-quoi-sert-wmi",level:2},{value:"Architecture du service WMI",id:"architecture-du-service-wmi",level:2},{value:"Les objets g\xe9r\xe9s et les providers WMI",id:"les-objets-g\xe9r\xe9s-et-les-providers-wmi",level:3},{value:"Infrastructure WMI",id:"infrastructure-wmi",level:3},{value:"Consommateurs WMI",id:"consommateurs-wmi",level:3},{value:"Le <em>WMI Repository</em>",id:"le-wmi-repository",level:3},{value:"Le langage WQL",id:"le-langage-wql",level:3},{value:"Utilisation de WMI avec PowerShell",id:"utilisation-de-wmi-avec-powershell",level:2},{value:"Commande <em>Get-WmiObject</em>",id:"commande-get-wmiobject",level:2},{value:"\xc9num\xe9ration des classes WMI",id:"\xe9num\xe9ration-des-classes-wmi",level:2},{value:"Quelques classes int\xe9ressantes",id:"quelques-classes-int\xe9ressantes",level:3},{value:"Collectins d&#39;objets et filtrage",id:"collectins-dobjets-et-filtrage",level:2},{value:"Avec <em>Where-Object</em>",id:"avec-where-object",level:3},{value:"Dans la requ\xeate WMI",id:"dans-la-requ\xeate-wmi",level:3},{value:"Dans une requ\xeate WQL",id:"dans-une-requ\xeate-wql",level:3},{value:"Membres des objets",id:"membres-des-objets",level:2},{value:"Propri\xe9t\xe9s",id:"propri\xe9t\xe9s",level:3},{value:"M\xe9thodes",id:"m\xe9thodes",level:3},{value:"Option 1: Par un appel de m\xe9thode sur l&#39;objet",id:"option-1-par-un-appel-de-m\xe9thode-sur-lobjet",level:4},{value:"Option 2: Avec la commande <em>Invoke-WmiMethod</em>",id:"option-2-avec-la-commande-invoke-wmimethod",level:4},{value:"Passage de param\xe8tres",id:"passage-de-param\xe8tres",level:4},{value:"Cacher l&#39;objet de retour",id:"cacher-lobjet-de-retour",level:4},{value:"Outils",id:"outils",level:2},{value:"WBEMTest",id:"wbemtest",level:3},{value:"WMIExplorer 2.0",id:"wmiexplorer-20",level:3},{value:"PowerShell WMI Browser",id:"powershell-wmi-browser",level:3},{value:"WMI Explorer 2.0 (mon pr\xe9f\xe9r\xe9)",id:"wmi-explorer-20-mon-pr\xe9f\xe9r\xe9",level:2}],c={toc:d},m="wrapper";function k(e){let{components:t,...l}=e;return(0,r.kt)(m,(0,a.Z)({},c,l,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"rencontre-9---requ\xeates-wmi"},"Rencontre 9 - Requ\xeates WMI"),(0,r.kt)("admonition",{title:"R\xe9sum\xe9 de la s\xe9ance du jeudi 16 novembre 2023",type:"note"},(0,r.kt)(s.Z,{mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"deroulement",label:"\ud83d\udc68\u200d\ud83c\udfeb D\xe9roulement du cours",mdxType:"TabItem"},(0,r.kt)("ol",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ol"},"Pr\xe9sentation de WMI"),(0,r.kt)("li",{parentName:"ol"},"Le langage WQL"),(0,r.kt)("li",{parentName:"ol"},"Interrogation de WMI avec PowerShell"),(0,r.kt)("li",{parentName:"ol"},"Outils d'exploration de WMI"))),(0,r.kt)(i.Z,{value:"exercices",label:"\ud83d\udcbb Exercices \xe0 compl\xe9ter",mdxType:"TabItem"},(0,r.kt)("p",{parentName:"admonition"},"Faites la partie 1 du ",(0,r.kt)("a",{parentName:"p",href:"/b64-scriptage-sous-windows/tp/tp2#partie-1-script-de-lancement"},"TP2"),".")),(0,r.kt)(i.Z,{value:"ressources",label:"\ud83d\udcda Ressources \xe0 consulter",mdxType:"TabItem"},(0,r.kt)("p",{parentName:"admonition"},"La pr\xe9sentation PowerPoint est sur le Teams du cours, sous le canal G\xe9n\xe9ral > Fichiers > Supports de cours.")))),(0,r.kt)("p",null,"WMI (Windows Management Instrumentation) est l'impl\xe9mentation par Microsoft du standard ouvert WBEM (Web-Based Enterprise Management) permettant la gestion centralis\xe9e et unifi\xe9e d'\xe9quipements informatiques en entreprise, lui-m\xeame d\xe9riv\xe9 d'un autre standard ouvert, CIM (Common Information Model). "),(0,r.kt)("p",null,"WMI a \xe9t\xe9 introduit nativement dans Windows depuis Windows 2000, et est encore activement utilis\xe9 aujourd'hui par des administrateurs de syst\xe8me afin de g\xe9rer des parcs informatiques de mani\xe8re centralis\xe9e et automatis\xe9e."),(0,r.kt)("h2",{id:"\xe0-quoi-sert-wmi"},"\xc0 quoi sert WMI?"),(0,r.kt)("p",null,"Gr\xe2ce \xe0 WMI, on peut interroger et contr\xf4ler le syst\xe8me d'exploitation Windows. WMI est en quelque sorte une librairie de classes servant \xe0 acc\xe9der diff\xe9rentes ressources du syst\xe8me. Ces ressources sont, par exemple, les propri\xe9t\xe9s de notre ordinateur (mod\xe8le, fabricant, num\xe9ro de s\xe9rie, etc.), les diff\xe9rents composants mat\xe9riels, les applications install\xe9es, la configuration r\xe9seau, etc."),(0,r.kt)("p",null,"Bien s\xfbr, PowerShell offre certaines commandes servant \xe0 obtenir des informations sur le syst\xe8me. Par exemple, Get-Process, Get-Service, Get-LocalUser, etc. Mais souvent, ces commandes utilisent WMI en arri\xe8re-plan. WMI est beaucoup plus grand et vaste que ce que les commandes PowerShell peuvent nous offrir."),(0,r.kt)("p",null,"Voici quelques exemples de ce qu'on peut faire avec WMI dans un script:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Savoir si le PC est un portable, un ordinateur de table, un serveur tour, un serveur en rack, etc."),(0,r.kt)("li",{parentName:"ul"},"Conna\xeetre le mod\xe8le du PC, son fabricant, son num\xe9ro de s\xe9rie, etc."),(0,r.kt)("li",{parentName:"ul"},"Obtenir la liste de tous les p\xe9riph\xe9riques branch\xe9s"),(0,r.kt)("li",{parentName:"ul"},"Obtenir le mod\xe8le et le num\xe9ro de s\xe9rie de la batterie d'un laptop"),(0,r.kt)("li",{parentName:"ul"},"Obtenir la configuration de la table de routage interne de Windows"),(0,r.kt)("li",{parentName:"ul"},"Obtenir la liste et la date d'installation de toutes les mises \xe0 jour de Windows install\xe9es"),(0,r.kt)("li",{parentName:"ul"},"Obtenir la liste des imprimantes configur\xe9es"),(0,r.kt)("li",{parentName:"ul"},"Obtenir la liste des partages r\xe9seau"),(0,r.kt)("li",{parentName:"ul"},"Obtenir la liste de toutes les cartes r\xe9seau configur\xe9es, avec leur adresses MAC et IP"),(0,r.kt)("li",{parentName:"ul"},"Et de nombreuses autres choses, dont certaines impossibles \xe0 faire avec les consoles et les commandes existantes.")),(0,r.kt)("p",null,"Et encore l\xe0, ce n'est que la superficie de ce que WMI permet de r\xe9aliser. Autrement dit, WMI donne \xe0 nos script la possibilit\xe9 d'administrer le syst\xe8me sur lequel il est lanc\xe9\u2026 et m\xeame sur des ordinateurs distants!"),(0,r.kt)("p",null,"Conna\xeetre comment utiliser WMI est vraiment essentiel pour tout administrateur Windows."),(0,r.kt)("h2",{id:"architecture-du-service-wmi"},"Architecture du service WMI"),(0,r.kt)("p",null,"WMI est structur\xe9e en trois principales couches: Les fournisseurs (providers), l'infrastructure et les consommateurs (consumers)."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(95782).Z,width:"510",height:"361"})),(0,r.kt)("h3",{id:"les-objets-g\xe9r\xe9s-et-les-providers-wmi"},"Les objets g\xe9r\xe9s et les providers WMI"),(0,r.kt)("p",null,"Un objet g\xe9r\xe9 (",(0,r.kt)("em",{parentName:"p"},"managed object"),") est un composant logiciel ou mat\xe9riel, tel qu'un disque dur, une carte r\xe9seau, un processus, un service, une application, etc. Ces objets sont acc\xe9d\xe9s par un fournisseur (",(0,r.kt)("em",{parentName:"p"},"WMI provider"),") qui, \xe0 la mani\xe8re d'un driver, rendent accessibles certaines informations et fonctions les concernant, sous forme de classes. Ces classes poss\xe8dent des propri\xe9t\xe9s et des m\xe9thodes, et d\xe9finissent la nature des objets, lesquels peuvent \xeatre pr\xe9sents en plusieurs instances."),(0,r.kt)("p",null,"Sous Windows, plusieurs fournisseurs WMI de base sont pr\xe9install\xe9s. Ainsi, le fournisseur ",(0,r.kt)("inlineCode",{parentName:"p"},"StrRegProv")," permet d'interroger la base de registre de Windows \xe0 travers WMI, et le fournisseur Win32 permet de manipuler et d'interroger les propri\xe9t\xe9s du syst\xe8me d'exploitation (processus, services, etc.)"),(0,r.kt)("h3",{id:"infrastructure-wmi"},"Infrastructure WMI"),(0,r.kt)("p",null,"L'infrastructure WMI est un composant de Windows servant \xe0 rendre accessibles les objets g\xe9r\xe9s WMI aux consommateurs. \xc0 l'instar d'un syst\xe8me de base de donn\xe9es, elle comprend un repository (une sorte de base de donn\xe9es) ainsi qu'un service pour traiter les requ\xeates."),(0,r.kt)("p",null,"Le repository est organis\xe9 sous forme de namespaces, de sorte \xe0 former une arborescence sous une racine appel\xe9e ",(0,r.kt)("inlineCode",{parentName:"p"},"ROOT"),". Dans ces namespaces se retrouvent les diff\xe9rentes classes offertes par les providers. Certains namespaces sont cr\xe9\xe9s automatiquement par le service WMI, mais la plupart sont cr\xe9\xe9s par les diff\xe9rents providers enregistr\xe9s dans le syst\xe8me."),(0,r.kt)("p",null,"\xc0 la mani\xe8re d'une base de donn\xe9es, on peut interroger le repository en envoyant des requ\xeates \xe0 un service charg\xe9 de les traiter. Ce service se nomme winmgmt et fait partie des services de base de Windows. De plus, le service WMI peut \xeatre acc\xe9d\xe9 \xe0 distance \xe0 travers le r\xe9seau (\xe0 condition que le consommateur dispose de droits d'administration sur la machine distante et que le pare-feu soit correctement configur\xe9)."),(0,r.kt)("h3",{id:"consommateurs-wmi"},"Consommateurs WMI"),(0,r.kt)("p",null,"Le consommateur WMI est toute application ou script qui souhaite interroger la base WMI. Il peut \xe9num\xe9rer les ",(0,r.kt)("em",{parentName:"p"},"namespaces"),", les classes et leurs instances (objets), interroger leurs propri\xe9t\xe9s et ex\xe9cuter leurs m\xe9thodes. Les scripts d'administration sous Windows sont tr\xe8s fr\xe9quemment des consommateurs WMI, puisque c'est souvent l'unique mani\xe8re d'interagir avec certaines propri\xe9t\xe9s du syst\xe8me d'exploitation."),(0,r.kt)("h3",{id:"le-wmi-repository"},"Le ",(0,r.kt)("em",{parentName:"h3"},"WMI Repository")),(0,r.kt)("p",null,"Essentiellement, la base WMI est compos\xe9e d'espaces de nommage, ou ",(0,r.kt)("em",{parentName:"p"},"namespaces"),", dispos\xe9s en arborescence sous la racine ",(0,r.kt)("inlineCode",{parentName:"p"},"ROOT"),". Le ",(0,r.kt)("em",{parentName:"p"},"namespace")," le plus couramment utilis\xe9 dans les scripts d'administration est ",(0,r.kt)("inlineCode",{parentName:"p"},"ROOT\\cimv2"),", et il est g\xe9n\xe9ralement consid\xe9r\xe9 comme le ",(0,r.kt)("em",{parentName:"p"},"namespace")," par d\xe9faut."),(0,r.kt)("p",null,"Dans ce ",(0,r.kt)("em",{parentName:"p"},"namespace")," se trouvent les classes qui permettent d'obtenir des informations sp\xe9cifiques \xe0 Windows. Ces classes ont un nom qui d\xe9bute par le pr\xe9fixe Win32. Il existe d'autres classes dans ce ",(0,r.kt)("em",{parentName:"p"},"namespace"),", dont plusieurs commencent par le pr\xe9fixe CIM, mais elle ne sont pas int\xe9ressantes puisque plus limit\xe9es. Elle sont seulement l\xe0 pour respecter le standard CIM duquel WMI est inspir\xe9."),(0,r.kt)("p",null,"Les ressources du syst\xe8me sont des instances de ces classes, ou objets, qui poss\xe8dent des propri\xe9t\xe9s et des m\xe9thodes. Cette structure est directement inspir\xe9e par le paradigme orient\xe9-objet."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(75990).Z,width:"760",height:"390"})),(0,r.kt)("p",null,"L'illustration ci-dessous montre l'outil ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/vinaypamnani/wmie2/releases"},"WMI Explorer"),", permettant de naviguer au sein du repository WMI. Vous y voyez, de gauche \xe0 droite, les namespaces, les classes pr\xe9sentes dans le namespace s\xe9lectionn\xe9, les instances de cette classe, ainsi que les propri\xe9t\xe9s de l'instance. Dans cet exemple, la classe ",(0,r.kt)("inlineCode",{parentName:"p"},"Win32_LocalDisk")," d\xe9finit ce qu'est un disque logique, et chaque instance de cette classe repr\xe9sente un disque logique reconnu par Windows. Chaque disque logique poss\xe8de des propri\xe9t\xe9s uniques, comme une lettre, une taille, un syst\xe8me de fichiers, etc. "),(0,r.kt)("p",null,"Cette application interroge le service WMI de la m\xeame mani\xe8re que vous pourriez le faire dans vos scripts. De ce fait, WMI un outil tr\xe8s puissant lorsqu'il est question de d\xe9velopper des scripts administratifs."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(45565).Z,width:"942",height:"731"})),(0,r.kt)("h3",{id:"le-langage-wql"},"Le langage WQL"),(0,r.kt)("p",null,"Le langage WQL (WMI Query Language) est un d\xe9riv\xe9 du SQL et sert \xe0 effectuer des requ\xeates au service WMI."),(0,r.kt)("p",null,"Pour effectuer une requ\xeate simple, on utilise la clause ",(0,r.kt)("inlineCode",{parentName:"p"},"SELECT")," pour sp\xe9cifier le nom des propri\xe9t\xe9s \xe0 inclure \xe0 la requ\xeate et la clause ",(0,r.kt)("inlineCode",{parentName:"p"},"FROM")," pour sp\xe9cifier la classe WMI."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT Name, FileSystem, Size, FreeSpace FROM Win32_LogicalDisk\n")),(0,r.kt)("p",null,"On peut voir toutes les propri\xe9t\xe9s avec ",(0,r.kt)("inlineCode",{parentName:"p"},"SELECT *"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT * FROM Win32_LogicalDisk\n")),(0,r.kt)("p",null,"On peut ajouter un filtre \xe0 l'aide de la clause ",(0,r.kt)("inlineCode",{parentName:"p"},"WHERE")," avec une condition (",(0,r.kt)("em",{parentName:"p"},"propri\xe9t\xe9 op\xe9rateur constante"),")."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT * FROM Win32_LogicalDisk WHERE FileSystem = 'NTFS'\n")),(0,r.kt)("p",null,"Les op\xe9rateurs admissibles sont:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Op\xe9rateur"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"=")),(0,r.kt)("td",{parentName:"tr",align:null},"\xc9gal \xe0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"<")),(0,r.kt)("td",{parentName:"tr",align:null},"Plus petit que")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},">")),(0,r.kt)("td",{parentName:"tr",align:null},"Plus grand que")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"<=")),(0,r.kt)("td",{parentName:"tr",align:null},"Plus petit ou \xe9gal \xe0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},">","=")),(0,r.kt)("td",{parentName:"tr",align:null},"Plus grand ou \xe9gal \xe0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"!=")," ou ",(0,r.kt)("strong",{parentName:"td"},"<",">")),(0,r.kt)("td",{parentName:"tr",align:null},"Diff\xe9rent de")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"IS NULL")),(0,r.kt)("td",{parentName:"tr",align:null},"Est nul")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"IS NOT NULL")),(0,r.kt)("td",{parentName:"tr",align:null},"N'est pas nul")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"AND")),(0,r.kt)("td",{parentName:"tr",align:null},"Et logique (pour sp\xe9cifier plusieurs conditions)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"OR")),(0,r.kt)("td",{parentName:"tr",align:null},"Ou logique (pour sp\xe9cifier plusieurs conditions)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"NOT")),(0,r.kt)("td",{parentName:"tr",align:null},"Non logique")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"LIKE")),(0,r.kt)("td",{parentName:"tr",align:null},"Comparaison de cha\xeene de caract\xe8re avec ",(0,r.kt)("em",{parentName:"td"},"wildcard"))))),(0,r.kt)("p",null,"Les wildcards admissibles avec l'op\xe9rateur ",(0,r.kt)("inlineCode",{parentName:"p"},"LIKE")," sont:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},(0,r.kt)("em",{parentName:"th"},"Wildcard")),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"%")),(0,r.kt)("td",{parentName:"tr",align:null},"N'importe quelle cha\xeene de 0 ou plus caract\xe8res")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"_")),(0,r.kt)("td",{parentName:"tr",align:null},"N'importe quel caract\xe8re (un seul)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"[ ]")),(0,r.kt)("td",{parentName:"tr",align:null},"Un caract\xe8re parmi les caract\xe8res en crochet (",(0,r.kt)("inlineCode",{parentName:"td"},"[a-f]")," ou ",(0,r.kt)("inlineCode",{parentName:"td"},"[abcdef]"),")")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"[^ ]")),(0,r.kt)("td",{parentName:"tr",align:null},"Un caract\xe8re autre que ceux sp\xe9cifi\xe9s en crochet (",(0,r.kt)("inlineCode",{parentName:"td"},"[^a-f]")," ou ",(0,r.kt)("inlineCode",{parentName:"td"},"[^abcdef]"),")")))),(0,r.kt)("p",null,"Voici un exemple de requ\xeate permettant d'obtenir toutes les imprimantes locales de marque HP."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},'Select * FROM Win32_Printer WHERE Local="TRUE" AND DriverName LIKE "%HP%"\n')),(0,r.kt)("h2",{id:"utilisation-de-wmi-avec-powershell"},"Utilisation de WMI avec PowerShell"),(0,r.kt)("p",null,"Il existe plusieurs mani\xe8res d'interroger le service WMI, mais la plus simple en PowerShell consiste \xe0 utiliser la commande ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-WmiObject"),", ou son alias ",(0,r.kt)("inlineCode",{parentName:"p"},"gwmi"),"."),(0,r.kt)("p",null,"La principale utilisation de la commande ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-WmiObject")," vise \xe0 obtenir une ou plusieurs instances d'une classe dans un ",(0,r.kt)("em",{parentName:"p"},"namespace")," donn\xe9. Il en r\xe9sulte \xe0 sa sortie un tableau d'objets qui poss\xe8dent les propri\xe9t\xe9s et les m\xe9thodes d\xe9finis par leur classe."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(77046).Z,width:"869",height:"201"})),(0,r.kt)("p",null,"Cette commande se comporte comme la plupart des commandes PowerShell, en ce sens qu'elle retourne un objet. Cet objet peut \xeatre manipul\xe9 \xe0 l'instar de tous les objets PowerShell."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(62414).Z,width:"869",height:"141"})),(0,r.kt)("p",null,"Le param\xe8tre ",(0,r.kt)("inlineCode",{parentName:"p"},"-Namespace")," est optionnel. Lorsqu'il est omis, la commande regarde dans ",(0,r.kt)("inlineCode",{parentName:"p"},"ROOT\\cimv2"),". Et on peut sp\xe9cifier la classe sans devoir sp\xe9cifier le nom du param\xe8tre ",(0,r.kt)("inlineCode",{parentName:"p"},"-Class"),". "),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(30626).Z,width:"869",height:"199"})),(0,r.kt)("p",null,"Les objets correspondant \xe0 une instance de classe WMI sont de type ManagementObject."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(63218).Z,width:"869",height:"168"})),(0,r.kt)("h2",{id:"commande-get-wmiobject"},"Commande ",(0,r.kt)("em",{parentName:"h2"},"Get-WmiObject")),(0,r.kt)("p",null,"Voici les principaux param\xe8tres qu'on peut fournir \xe0 ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-WmiObject"),":"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Param\xe8tre"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"-Class")),(0,r.kt)("td",{parentName:"tr",align:null},"Nom de la classe WMI dont on veut obtenir les instances.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"-Property")),(0,r.kt)("td",{parentName:"tr",align:null},"Propri\xe9t\xe9(s) \xe0 r\xe9cup\xe9rer (pour s'\xe9viter un ",(0,r.kt)("inlineCode",{parentName:"td"},"Select-Object"),")")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"-Namespace")),(0,r.kt)("td",{parentName:"tr",align:null},"Le ",(0,r.kt)("em",{parentName:"td"},"namespace")," o\xf9 se trouve la classe. Si ce param\xe8tre n'est pas sp\xe9cifi\xe9, c'est ",(0,r.kt)("inlineCode",{parentName:"td"},"ROOT\\cimv2")," qui est pris par d\xe9faut")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"-Filter")),(0,r.kt)("td",{parentName:"tr",align:null},"Sp\xe9cifie un filtre pour ne retourner que certains objets selon les crit\xe8res sp\xe9cifi\xe9s. Attention, ce param\xe8tre n'a pas la syntaxe PowerShell mais WQL (proche du SQL).")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"-Query")),(0,r.kt)("td",{parentName:"tr",align:null},"Au lieu des param\xe8tres ",(0,r.kt)("inlineCode",{parentName:"td"},"-Class"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"-Property")," et ",(0,r.kt)("inlineCode",{parentName:"td"},"-Filter"),", on peut d\xe9finir une cha\xeene de caract\xe8re repr\xe9sentant une requ\xeate WQL (par exemple, ",(0,r.kt)("inlineCode",{parentName:"td"},"SELECT * FROM Win32_LogicalDisk WHERE FileSystem = 'NTFS'"),")")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"-ComputerName")),(0,r.kt)("td",{parentName:"tr",align:null},"Nom de l'ordinateur sur lequel on veut effectuer la requ\xeate. Si ce param\xe8tre n'est pas sp\xe9cifi\xe9, c'est \"",(0,r.kt)("inlineCode",{parentName:"td"},"."),'" qui est sa valeur par d\xe9faut, ce qui correspond \xe0 la machine locale.')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"-Credential")),(0,r.kt)("td",{parentName:"tr",align:null},"Objet de type ",(0,r.kt)("inlineCode",{parentName:"td"},"[PSCredential]")," pour l'authentification. Cette notion sera couverte plus tard.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"-List")),(0,r.kt)("td",{parentName:"tr",align:null},"Affiche la liste des classes du ",(0,r.kt)("em",{parentName:"td"},"namespace")," (soit celui sp\xe9cifi\xe9 dans le param\xe8tre ",(0,r.kt)("inlineCode",{parentName:"td"},"-Namespace"),", soit ",(0,r.kt)("inlineCode",{parentName:"td"},"ROOT\\cimv2")," par d\xe9faut)")))),(0,r.kt)("p",null,"En sortie, ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-WmiObject")," envoie dans le pipeline un tableau d'objets de type ",(0,r.kt)("inlineCode",{parentName:"p"},"[ManagementObject]"),", ou un objet unique lorsqu'il n'y a qu'une instance. Cet objet peut \xeatre affect\xe9 \xe0 une variable, ou pass\xe9 \xe0 une autre commande via le pipeline, comme les commandes ",(0,r.kt)("inlineCode",{parentName:"p"},"Format-"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Out-"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Sort-"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Select-"),", etc. Autrement, cet objet tombe dans l'h\xf4te et est converti en texte."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(44589).Z,width:"869",height:"316"})),(0,r.kt)("p",null,"On voit cependant que cette commande retourne aussi certaines propri\xe9t\xe9s syst\xe8me propres \xe0 WMI, alors il peut \xeatre int\xe9ressant de passer cet objet dans un ",(0,r.kt)("inlineCode",{parentName:"p"},"Select-Object")," pour s\xe9lectionner les propri\xe9t\xe9s qu'on veut."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(24983).Z,width:"869",height:"258"})),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Le param\xe8tre ",(0,r.kt)("inlineCode",{parentName:"p"},"-Property")," de ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-WmiObject")," peut quand m\xeame \xeatre pratique en conjonction avec ",(0,r.kt)("inlineCode",{parentName:"p"},"Select-Object"),", car certains objets WMI ont un grand nombre de propri\xe9t\xe9s. WMI est un syst\xe8me particuli\xe8rement lent, alors si vous ne sp\xe9cifiez pas les propri\xe9t\xe9s dans ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-WmiObject"),", \xe7a pourrait nuire \xe0 la performance de votre script.")),(0,r.kt)("h2",{id:"\xe9num\xe9ration-des-classes-wmi"},"\xc9num\xe9ration des classes WMI"),(0,r.kt)("p",null,"On peut obtenir la liste des classes avec ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-WMIObject -List"),". Par d\xe9faut, on recherche dans le namespace ",(0,r.kt)("inlineCode",{parentName:"p"},"cimv2"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(55421).Z,width:"989",height:"275"})),(0,r.kt)("p",null,"Pour une recherche plus pr\xe9cise, on peut sp\xe9cifier un ",(0,r.kt)("strong",{parentName:"p"},"filtre"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(33219).Z,width:"989",height:"307"})),(0,r.kt)("h3",{id:"quelques-classes-int\xe9ressantes"},"Quelques classes int\xe9ressantes"),(0,r.kt)("p",null,"Voici quelques classes particuli\xe8rement utiles sous ",(0,r.kt)("inlineCode",{parentName:"p"},"ROOT\\cimv2"),":"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Classe"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Win32_ComputerSystem")),(0,r.kt)("td",{parentName:"tr",align:null},"Informations de base sur le syst\xe8me, comme le mod\xe8le et le fabricant, le hostname, le domaine AD, le fuseau horaire, le nombre de processeurs logiques, etc.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Win32_NetworkAdapter")),(0,r.kt)("td",{parentName:"tr",align:null},"Cartes r\xe9seau (physiques et logiques) install\xe9es.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Win32_NetworkAdapterConnection")),(0,r.kt)("td",{parentName:"tr",align:null},"Configuration des cartes r\xe9seau (puisqu'une carte r\xe9seau peut avoir plusieurs connections, il doit y avoir une classe diff\xe9rente)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Win32_NetworkConnection")),(0,r.kt)("td",{parentName:"tr",align:null},"Partages r\xe9seau mapp\xe9s.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Win32_LogicalDisk")),(0,r.kt)("td",{parentName:"tr",align:null},"Les disques durs logiques (C:, D:, etc.)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Win32_Account")),(0,r.kt)("td",{parentName:"tr",align:null},"Comptes utilisateurs et des groupes locaux.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Win32_UserAccount")),(0,r.kt)("td",{parentName:"tr",align:null},"Comptes utilisateurs locaux")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Win32_Group")),(0,r.kt)("td",{parentName:"tr",align:null},"Groupes locaux")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Win32_NTLogEvent")),(0,r.kt)("td",{parentName:"tr",align:null},"\xc9v\xe9nements du journal d'\xe9v\xe9nements Windows")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Win32_Process")),(0,r.kt)("td",{parentName:"tr",align:null},"Processus en ex\xe9cution")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Win32_Service")),(0,r.kt)("td",{parentName:"tr",align:null},"Services")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Win32_SystemEnclosure")),(0,r.kt)("td",{parentName:"tr",align:null},"Information sur le bo\xeetier et le facteur de forme (par exemple, pour distinguer les laptops, les tours, les serveurs rackmount, les tablettes, etc.)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Win32_BIOS")),(0,r.kt)("td",{parentName:"tr",align:null},"Information sur le BIOS (fabricant, version, r\xe9vision, etc.)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Win32_Battery")),(0,r.kt)("td",{parentName:"tr",align:null},"Information sur la batterie (charge restante...)")))),(0,r.kt)("h2",{id:"collectins-dobjets-et-filtrage"},"Collectins d'objets et filtrage"),(0,r.kt)("p",null,"Certaines classes n'ont qu'une seule instance (par exemple, ",(0,r.kt)("inlineCode",{parentName:"p"},"Win32_ComputerSystem"),"), mais d'autres en ont plusieurs. Lorsqu'on ex\xe9cute une requ\xeate WMI sur ces classes, on obtient un tableau d'objets."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(11658).Z,width:"869",height:"326"})),(0,r.kt)("p",null,"Il se trouve que par d\xe9faut, ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-WmiObject")," est format\xe9e en liste plut\xf4t qu'en tableau. Mais il s'agit bel et bien d'un objet et on peut le manipuler de la m\xeame mani\xe8re que toutes les autres collections PowerShell."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(76352).Z,width:"869",height:"303"})),(0,r.kt)("p",null,"Si on veut une instance sp\xe9cifique, on doit d\xe9finir un filtre. Il y a plusieurs mani\xe8res de proc\xe9der."),(0,r.kt)("h3",{id:"avec-where-object"},"Avec ",(0,r.kt)("em",{parentName:"h3"},"Where-Object")),(0,r.kt)("p",null,"On peut utiliser l'habituelle commande ",(0,r.kt)("inlineCode",{parentName:"p"},"Where-Object")," pour filtrer une collection et ne garder qu'une ou certaines de ses instances."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(1713).Z,width:"859",height:"189"})),(0,r.kt)("p",null,"Ou on peut aussi utiliser cette m\xe9thode pour obtenir une collection plus petite de toutes les instances qui ob\xe9issent \xe0 une condition pr\xe9cise. "),(0,r.kt)("p",null,"Dans cet exemple, on filtre pour ne retenir que les disques locaux et non les disques r\xe9seau. Selon la documentation, la propri\xe9t\xe9 ",(0,r.kt)("inlineCode",{parentName:"p"},"DriveType")," prend la valeur 3 pour un disque local et 4 pour un lecteur r\xe9seau. "),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(36506).Z,width:"869",height:"157"})),(0,r.kt)("h3",{id:"dans-la-requ\xeate-wmi"},"Dans la requ\xeate WMI"),(0,r.kt)("p",null,"On peut utiliser le param\xe8tre ",(0,r.kt)("inlineCode",{parentName:"p"},"-Filter")," de ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-WmiObject")," pour d\xe9finir les crit\xe8res."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(53001).Z,width:"869",height:"211"})),(0,r.kt)("p",null,"Cette technique pr\xe9f\xe9rable \xe0 ",(0,r.kt)("inlineCode",{parentName:"p"},"Where-Object")," dans la plupart des cas, car avec cette derni\xe8re, toutes les instances circulent dans le pipeline avant le ",(0,r.kt)("inlineCode",{parentName:"p"},"Where-Object"),". "),(0,r.kt)("p",null,"Supposons que le r\xe9sultat de la requ\xeate ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-WmiObject")," donnait un million d'instances. Avec ",(0,r.kt)("inlineCode",{parentName:"p"},"Where-Object"),", il aurait fallu accumuler un million d'objets dans le pipeline, avant le filtrage. Lorsqu'on sp\xe9cifie le filtre dans la requ\xeate WMI, on \xe9vite de manipuler les objets qu'on ne veut pas. Ainsi, on gagne en performance et on \xe9vite de surutiliser la m\xe9moire du syst\xe8me."),(0,r.kt)("p",null,"Le d\xe9savantage de cette m\xe9thode, c'est que les crit\xe8res doivent \xeatre d\xe9finis en WQL et non en PowerShell. WQL est un langage plus limit\xe9 que PowerShell. Il arrive parfois qu'on doive faire une partie du travail de filtrage par la requ\xeate WMI, puis une autre passe, plus fine, avec ",(0,r.kt)("inlineCode",{parentName:"p"},"Where-Object"),"."),(0,r.kt)("h3",{id:"dans-une-requ\xeate-wql"},"Dans une requ\xeate WQL"),(0,r.kt)("p",null,"Lorsqu'on choisit d'utiliser une requ\xeate WQL, le filtre doit \xeatre d\xe9fini apr\xe8s la clause ",(0,r.kt)("inlineCode",{parentName:"p"},"WHERE"),", de la m\xeame mani\xe8re qu'en SQL."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(65828).Z,width:"869",height:"224"})),(0,r.kt)("h2",{id:"membres-des-objets"},"Membres des objets"),(0,r.kt)("p",null,"La commande ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-WmiObject")," s'utilise de la m\xeame mani\xe8re que ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-Process"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-Service")," ou ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-ChildItem"),". Il sort de cette commande un objet (lorsque WMI ne poss\xe8de qu'une seule instance de cette classe) ou un tableau d'objets (lorsque WMI poss\xe8de plusieurs instances). Ces objets ont des membres (des propri\xe9t\xe9s et des m\xe9thodes) correspondant \xe0 celles de leur classe. Les techniques pour explorer ces objets \xe0 la recherche de ce qu'on peut exploiter sont donc semblables \xe0 ce qu'on peut faire avec les objets retourn\xe9s par les commandes natives de PowerShell."),(0,r.kt)("p",null,"La classe ",(0,r.kt)("inlineCode",{parentName:"p"},"Win32_OperatingSystem")," d\xe9finit plusieurs propri\xe9t\xe9s d'un syst\xe8me d'exploitation Windows. Comme il n'y a qu'un seul syst\xe8me d'exploitation actif dans un syst\xe8me, il n'y a qu'un objet, et non une instance d'objets, qui sort de la commande. Avec un ",(0,r.kt)("inlineCode",{parentName:"p"},"Select-Object *")," ou un ",(0,r.kt)("inlineCode",{parentName:"p"},"Format-List *"),", on peut forcer PowerShell \xe0 afficher toutes les propri\xe9t\xe9s de l'objet."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(11907).Z,width:"869",height:"460"})),(0,r.kt)("p",null,"S'il y a plusieurs instances de la classe recherch\xe9e, il faut \xeatre un peu plus cr\xe9atif. On pourrait s\xe9lectionner un seul objet pour observer son contenu:"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(33678).Z,width:"869",height:"207"})),(0,r.kt)("p",null,"Ou encore utiliser ",(0,r.kt)("inlineCode",{parentName:"p"},"Out-GridView"),"\u2026"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(34244).Z,width:"869",height:"255"})),(0,r.kt)("p",null,"Ou bien exporter en CSV pour pouvoir importer directement dans Excel!"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(94415).Z,width:"850",height:"448"})),(0,r.kt)("p",null,"Une autre approche consiste \xe0 utiliser ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-Member"),". On peut voir les propri\xe9t\xe9s, mais aussi les m\xe9thodes pouvant \xeatre appel\xe9es sur cet objet. On peut aussi conna\xeetre le type de donn\xe9es de ces propri\xe9t\xe9s. Cependant, cela ne nous permet pas de voir le contenu."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(98589).Z,width:"869",height:"292"})),(0,r.kt)("p",null,"On peut aussi utiliser le param\xe8tre ",(0,r.kt)("inlineCode",{parentName:"p"},"-MemberType")," de ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-Member")," pour n'afficher que les propri\xe9t\xe9s ou les m\xe9thodes."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(58191).Z,width:"869",height:"195"})),(0,r.kt)("h3",{id:"propri\xe9t\xe9s"},"Propri\xe9t\xe9s"),(0,r.kt)("p",null,"On interroge les propri\xe9t\xe9s d'un objet WMI de la m\xeame mani\xe8re que sur un objet ordinaire. On peut manipuler les propri\xe9t\xe9s \xe0 notre guise et faire toutes les manipulations qu'on souhaite."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(29161).Z,width:"988",height:"645"})),(0,r.kt)("h3",{id:"m\xe9thodes"},"M\xe9thodes"),(0,r.kt)("p",null,"Il y a plus d'une mani\xe8re d'appeler une m\xe9thode sur un objet WMI."),(0,r.kt)("h4",{id:"option-1-par-un-appel-de-m\xe9thode-sur-lobjet"},"Option 1: Par un appel de m\xe9thode sur l'objet"),(0,r.kt)("p",null,"Cette technique revient \xe0 simplement appeler une m\xe9thode comme vous \xeates habitu\xe9s de le faire. L'exemple ici se fait avec une variable pour, mais on pourrait tr\xe8s bien le faire sur la m\xeame ligne."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(40779).Z,width:"871",height:"300"})),(0,r.kt)("p",null,"Notez ci-dessus qu'un objet est retourn\xe9. Cet objet sert transmettre au consommateur de WMI un code de retour, o\xf9 0 signifie un succ\xe8s, et n'importe quelle autre valeur signifie qu'une erreur est survenue."),(0,r.kt)("p",null,"Lorsqu'il y a plusieurs processus du m\xeame nom (ici, deux processus ",(0,r.kt)("em",{parentName:"p"},"notepad.exe"),"), alors la m\xe9thode est ex\xe9cut\xe9e \xe0 chacun des objets, sans qu'on n'ait besoin de faire une boucle."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(33589).Z,width:"869",height:"456"})),(0,r.kt)("h4",{id:"option-2-avec-la-commande-invoke-wmimethod"},"Option 2: Avec la commande ",(0,r.kt)("em",{parentName:"h4"},"Invoke-WmiMethod")),(0,r.kt)("p",null,"On peut aussi utiliser la commande ",(0,r.kt)("inlineCode",{parentName:"p"},"Invoke-WmiMethod"),". Il suffit de lui passer un objet WMI dans le pipeline et sp\xe9cifier le nom de la m\xe9thode."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(78896).Z,width:"869",height:"284"})),(0,r.kt)("h4",{id:"passage-de-param\xe8tres"},"Passage de param\xe8tres"),(0,r.kt)("p",null,"On peut passer des param\xe8tres aux m\xe9thodes WMI. Cependant, il faut souvent se fier \xe0 la documentation de Microsoft pour conna\xeetre quels param\xe8tres passer et dans quel format."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(4709).Z,width:"869",height:"536"})),(0,r.kt)("h4",{id:"cacher-lobjet-de-retour"},"Cacher l'objet de retour"),(0,r.kt)("p",null,"Si, dans votre script, vous souhaitez invoquer une m\xe9thode d'un objet WMI, vous ne voulez pas vraiment que le script affiche l'objet de retour."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(66401).Z,width:"1007",height:"645"})),(0,r.kt)("p",null,"Une mani\xe8re de faire est d'affecter cet objet dans une variable. Ainsi, il ne tomberait pas dans la console \xe0 la fin du pipeline. Cependant, ce n'est pas propre puisqu'on utilise de la m\xe9moire inutilement (\xe0 moins, bien s\xfbr, qu'on souhaite utiliser cet objet par la suite)."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(65324).Z,width:"1007",height:"197"})),(0,r.kt)("p",null,"On pourrait aussi affecter cet objet dans une variable, mais cette fois, dans la variable $null. Cette variable est sp\xe9ciale car elle est toujours vide. Donc si on affecte l'objet dans cette variable, il n'aboutit pas dans la console et sa r\xe9f\xe9rence est instantan\xe9ment d\xe9truite."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(7299).Z,width:"1007",height:"196"})),(0,r.kt)("p",null,"Il y a une mani\xe8re plus propre et beaucoup plus explicite d'envoyer un objet dans le n\xe9ant. Il suffit de terminer le pipeline avec la commande de sortie Out-Null."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(9455).Z,width:"1007",height:"357"})),(0,r.kt)("h2",{id:"outils"},"Outils"),(0,r.kt)("p",null,"Plusieurs outils permettent d'explorer WMI de mani\xe8re conviviale. Cela peut vous aider grandement dans vos scripts!"),(0,r.kt)("h3",{id:"wbemtest"},"WBEMTest"),(0,r.kt)("p",null,"C'est un outil inclus dans Windows. Il permet d'explorer WMI, mais il est difficile \xe0 utiliser et peu convivial. WMI est beaucoup plus vaste et complexe que ce qui est couvert dans ce cours, et cet outil permet d'explorer la m\xe9canique interne de WMI. Par contre, l'outil est inclus dans Windows (tapez simplement \"wbemtest\" dans une ligne de commande pour le lancer), ce qui vous \xe9vite de devoir t\xe9l\xe9charger un outil."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(5587).Z,width:"1090",height:"671"})),(0,r.kt)("p",null,"Voici l'article de la documentation portant sur cet outil:\n",(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/mem/configmgr/develop/core/understand/introduction-to-wbemtest"},"https://docs.microsoft.com/en-us/mem/configmgr/develop/core/understand/introduction-to-wbemtest")),(0,r.kt)("h3",{id:"wmiexplorer-20"},"WMIExplorer 2.0"),(0,r.kt)("p",null,"Cet outil est le meilleur que je connaisse, et il est gratuit. Il peut se connecter sur la machine locale ou une machine distante sur le r\xe9seau, et permet de g\xe9n\xe9rer des scripts automatiquement! Je vous encourage fortement \xe0 l'essayer."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(40282).Z,width:"1076",height:"638"})),(0,r.kt)("p",null,"Vous pouvez le t\xe9l\xe9charger ici:\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/vinaypamnani/wmie2/releases/latest"},"https://github.com/vinaypamnani/wmie2/releases/latest")," "),(0,r.kt)("h3",{id:"powershell-wmi-browser"},"PowerShell WMI Browser"),(0,r.kt)("p",null,"Cet outil est aussi gratuit et t\xe9l\xe9chargeable sur Internet. Il n'est pas aussi avanc\xe9 que WMIExplorer, mais il est programm\xe9 compl\xe8tement en PowerShell! Vous pouvez voir son code."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(55404).Z,width:"1196",height:"587"})),(0,r.kt)("p",null,"Oui, on peut faire des interfaces graphiques en PowerShell! :-)"),(0,r.kt)("p",null,"Vous pouvez le t\xe9l\xe9charger ici:\n",(0,r.kt)("a",{parentName:"p",href:"https://jdhitsolutions.com/blog/powershell/2848/wmi-explorer-from-the-powershell-guy/"},"https://jdhitsolutions.com/blog/powershell/2848/wmi-explorer-from-the-powershell-guy/")),(0,r.kt)("p",null,"Il y en a d'autres, mais ils sont soit payants ou d\xe9suets. Les outils ci-dessus, en plus de la commande ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-WmiObject"),", vous donneront tout ce qu'il vous faut pour utiliser WMI!"),(0,r.kt)("h2",{id:"wmi-explorer-20-mon-pr\xe9f\xe9r\xe9"},"WMI Explorer 2.0 (mon pr\xe9f\xe9r\xe9)"),(0,r.kt)("p",null,"Cet outil est le meilleur que je connaisse, et il est gratuit. Vous pouvez le t\xe9l\xe9charger sur le site GitHub de son d\xe9veloppeur (",(0,r.kt)("a",{parentName:"p",href:"https://github.com/vinaypamnani/wmie2/releases/latest"},"https://github.com/vinaypamnani/wmie2/releases/latest"),")"),(0,r.kt)("p",null,"Lorsque vous ouvrez cet outil, vous pouvez parcourir les diff\xe9rents namespaces. Un double-clic sur le namespace \xe9num\xe8re ses classes, et un double-clic sur une classe \xe9num\xe8re ses instances. Finalement, s\xe9lectionnez une instance et vous aurez toutes ses propri\xe9t\xe9s. Vous pouvez sp\xe9cifier un ordinateur diff\xe9rent du votre (le \".\" r\xe9f\xe8re \xe0 l'ordinateur local). En prime, vous avez en tout temps au bas de la fen\xeatre la requ\xeate WQL correspondant \xe0 l'instance que vous avez s\xe9lectionn\xe9e."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(26292).Z,width:"1076",height:"638"})),(0,r.kt)("p",null,"Dans l'onglet Properties, vous avez une liste de toutes les propri\xe9t\xe9s de la classe s\xe9lectionn\xe9e, tir\xe9e de la documentation de WMI."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(67519).Z,width:"801",height:"405"})),(0,r.kt)("p",null,"Et dans l'onglet Methods, vous avez la m\xeame chose mais pour les m\xe9thodes, avec la d\xe9finition des param\xe8tres d'entr\xe9e et de sortie. Attention, ces m\xe9thodes ne se comportent pas comme des m\xe9thodes classique appel\xe9es dans PowerShell, et il peut \xeatre un peu ardu de les utiliser."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(43785).Z,width:"801",height:"503"})),(0,r.kt)("p",null,"D'ailleurs, pour ex\xe9cuter une m\xe9thode, il suffit de cliquer-droit sur l'instance (pour un m\xe9thode non statique) ou sur la classe (pour une m\xe9thode statique)."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(56993).Z,width:"539",height:"286"})),(0,r.kt)("p",null,"Mais l\xe0 o\xf9 cet outil devient vraiment int\xe9ressant (et presque de la triche), c'est dans l'onglet Script. Vous pouvez g\xe9n\xe9rer automatiquement un bout de code PowerShell qui r\xe9cup\xe8re toutes les propri\xe9t\xe9s des instances de la classe, et le coller dans votre script. Le bout de code tel quel ne sert pas \xe0 grand-chose, mais il vous donne un exemple d'utilisation de toutes les propri\xe9t\xe9s des objets. Vous n'avez ensuite \xe0 prendre ce que vous voulez. L'outil ne fait pas tout le travail, mais en fait une partie \xe0 votre place. "),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(26350).Z,width:"810",height:"343"})))}k.isMDXComponent=!0},77046:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi01-9d863df4780837d1f7981c0e7490db4d.png"},62414:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi02-ebcb45a5f75ffac7d438b0ef338bcc9d.png"},30626:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi03-86b9d6e14fe2255b786672d188af0999.png"},63218:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi04-b508cb1aac420f72da8231b2b011988d.png"},44589:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi05-601c95746cae1bb5f9d4c4fa4c4d1d89.png"},24983:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi06-5148068ca86d2049ee6ccc3c13ac2f1d.png"},55421:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi07-dd3004a126da7cdfbefcec367775d914.png"},33219:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi08-648677b10a9b954cec0f785de668b4b2.png"},11658:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi09-6feb9ffe56c5b165ac3d76180b51954d.png"},76352:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi10-7978c3474d188e1585d6fa0e34ae21bb.png"},1713:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi11-ab542dcc2dd20bb9c6e0274982516ec7.png"},36506:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi12-506d843e201d83bc71f1d0c074040cd2.png"},53001:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi13-d6a1139a9f153131ef73dd9d6e30c331.png"},65828:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi14-2af10bd658279afa9ac7e98fc8dc92d7.png"},11907:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi15-4ebe5f7c4527fbe894f6a69249c632a6.png"},33678:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi16-6befea1ba421d92cc264ecf8e6552c95.png"},34244:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi17-14d014aea13d973042ecff24f39e8ea2.png"},94415:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi18-406300190e1370639dfeecb95db0f695.png"},98589:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi19-0c74250f67bc30d2af718dfb9d613d38.png"},58191:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi20-4a41551b1134041ec4696d889a821d12.png"},29161:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi21-a4c2511ae4202101bd0e957ded72c379.png"},40779:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi22-d2dcd0ae16e25833539651b994543929.png"},33589:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi23-09ce9fca15c7736db6f747bbcd863f2e.png"},78896:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi24-fe4ce13c469d62ec895b417121bc6be2.png"},4709:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi25-dd50654768ae8542477836757cbbeadb.png"},66401:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi26-5425472054116d5148e97331c7982c72.png"},65324:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi27-084c668ca0310f23a82eece0d99e2ff5.png"},7299:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi28-78111d56e6022ed628ef467987c3e2c1.png"},9455:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gwmi29-846567da6d1e733192010797663dc6e4.png"},5587:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/outil_wbemtest-50b90a11875e77939aa83248cf010771.png"},55404:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/outil_wmibrowser-9c256a8275c446c4c3ef578e6d2cbb94.png"},26292:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/outil_wmie01-78af8774aaccedf11036cda33861cae5.png"},67519:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/outil_wmie02-ddc9325f98e94e97f623fab0847b3338.png"},43785:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/outil_wmie03-4672a56576a0b159e806a2f94de45d0f.png"},56993:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/outil_wmie04-a9f754a4328a7e39aa08429b70b4c76b.png"},26350:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/outil_wmie05-995ecddcf630e3c0b664ebafa79e0801.png"},40282:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/outil_wmiexplorer2-c98052bf76e9a9921dce30f6e8684050.png"},95782:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/wmi_architecture-46fa123c9dd1de2b730b98529fee19c9.png"},45565:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/wmi_explorer-21470452ed6f3e41e7fb6429623260be.png"},75990:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/wmi_structure-c253e33debaaa361122c814fb458c262.png"}}]);